<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://frccode.github.io/Learn/Chapter_8/vision_explanation/ rel=canonical><link href=../pose_estimators_and_kalman_filters/ rel=prev><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>Vision Processing: Getting Started - FRCCode.org</title><link rel=stylesheet href=../../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/material.min.css><link rel=stylesheet href=../../../css/pid-simulator.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#vision-processing-getting-started class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=FRCCode.org class="md-header__button md-logo" aria-label=FRCCode.org data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> FRCCode.org </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Vision Processing: Getting Started </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/frccode/frccode title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> frccode/frccode </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> FRCCode </a> </li> <li class=md-tabs__item> <a href=../../../support_and_help/ class=md-tabs__link> Support &amp; Help </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../Chapter_0/java_intro/ class=md-tabs__link> Learn </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=FRCCode.org class="md-nav__button md-logo" aria-label=FRCCode.org data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> FRCCode.org </label> <div class=md-nav__source> <a href=https://github.com/frccode/frccode title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> frccode/frccode </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> FRCCode </span> </a> </li> <li class=md-nav__item> <a href=../../../support_and_help/ class=md-nav__link> <span class=md-ellipsis> Support &amp; Help </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Learn </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Learn </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex> <span class=md-ellipsis> Chapter 0 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Chapter 0 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_0/java_intro/ class=md-nav__link> <span class=md-ellipsis> Introduction to Java in FRC Programming </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex> <span class=md-ellipsis> Chapter 1 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Chapter 1 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_1/1_prerequisites_intro/ class=md-nav__link> <span class=md-ellipsis> Prerequisites of FRC Programming </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_1/2_wpilib/ class=md-nav__link> <span class=md-ellipsis> WPIlib and Associated Tools </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_1/4_Version_Control_intro/ class=md-nav__link> <span class=md-ellipsis> Version Control Guide for FRC Teams </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex> <span class=md-ellipsis> Chapter 2 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Chapter 2 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_2/simple_robot_programming/ class=md-nav__link> <span class=md-ellipsis> An Intro Through Timed Robot </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex> <span class=md-ellipsis> Chapter 3 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Chapter 3 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_3/1_command_based_programming/ class=md-nav__link> <span class=md-ellipsis> Command-Based Robot Programming Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex> <span class=md-ellipsis> Chapter 4 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Chapter 4 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_4/PID/ class=md-nav__link> <span class=md-ellipsis> PID Control </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_4/simple_profiling/ class=md-nav__link> <span class=md-ellipsis> Motion Profiling: Getting Started </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex> <span class=md-ellipsis> Chapter 5 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Chapter 5 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_5/differential_control/ class=md-nav__link> <span class=md-ellipsis> Differential (Tank) Drive Programming Guide </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_5/drive_bases/ class=md-nav__link> <span class=md-ellipsis> Drive Base in FRC Programming </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_5/simple_trajectories/ class=md-nav__link> <span class=md-ellipsis> Swerve Trajectory: Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_5/swerve_control/ class=md-nav__link> <span class=md-ellipsis> Swerve Drive Programming Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex> <span class=md-ellipsis> Chapter 6 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Chapter 6 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_6/auto_strategy/ class=md-nav__link> <span class=md-ellipsis> FRC Autonomous Programming - Strategy and Planning </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_6/extrainfoPuttingelsewhere/ class=md-nav__link> <span class=md-ellipsis> extrainfoPuttingelsewhere </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_6/writing_autos/ class=md-nav__link> <span class=md-ellipsis> FRC Autonomous Programming - Technical Implementation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8 id=__nav_3_8_label tabindex> <span class=md-ellipsis> Chapter 7 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_8_label aria-expanded=false> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Chapter 7 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_7/logging_intro/ class=md-nav__link> <span class=md-ellipsis> Logging intro </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_9 checked> <label class=md-nav__link for=__nav_3_9 id=__nav_3_9_label tabindex> <span class=md-ellipsis> Chapter 8 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_9_label aria-expanded=true> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Chapter 8 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../apriltag_processing/ class=md-nav__link> <span class=md-ellipsis> AprilTag Processing: Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../pose_estimators_and_kalman_filters/ class=md-nav__link> <span class=md-ellipsis> Kalman Filters &amp; Pose Estimation: Getting Started </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Vision Processing: Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Vision Processing: Getting Started </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#1-why-vision-processing class=md-nav__link> <span class=md-ellipsis> 1. Why Vision Processing? </span> </a> <nav class=md-nav aria-label="1. Why Vision Processing?"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-power-of-robot-vision class=md-nav__link> <span class=md-ellipsis> The Power of Robot Vision </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-vision-processing-pipeline class=md-nav__link> <span class=md-ellipsis> 2. Vision Processing Pipeline </span> </a> <nav class=md-nav aria-label="2. Vision Processing Pipeline"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-step-by-step-process class=md-nav__link> <span class=md-ellipsis> The Step-by-Step Process </span> </a> </li> <li class=md-nav__item> <a href=#basic-vision-workflow class=md-nav__link> <span class=md-ellipsis> Basic Vision Workflow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-vision-architecture-options class=md-nav__link> <span class=md-ellipsis> 3. Vision Architecture Options </span> </a> <nav class=md-nav aria-label="3. Vision Architecture Options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#option-1-roborio-vision-simplest class=md-nav__link> <span class=md-ellipsis> Option 1: RoboRIO Vision (Simplest) </span> </a> </li> <li class=md-nav__item> <a href=#option-2-coprocessor-vision-recommended class=md-nav__link> <span class=md-ellipsis> Option 2: Coprocessor Vision (Recommended) </span> </a> </li> <li class=md-nav__item> <a href=#option-3-driver-station-vision class=md-nav__link> <span class=md-ellipsis> Option 3: Driver Station Vision </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-basic-vision-pipeline-implementation class=md-nav__link> <span class=md-ellipsis> 4. Basic Vision Pipeline Implementation </span> </a> <nav class=md-nav aria-label="4. Basic Vision Pipeline Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-color-filtering class=md-nav__link> <span class=md-ellipsis> Step 1: Color Filtering </span> </a> </li> <li class=md-nav__item> <a href=#step-2-contour-detection class=md-nav__link> <span class=md-ellipsis> Step 2: Contour Detection </span> </a> </li> <li class=md-nav__item> <a href=#step-3-target-filtering class=md-nav__link> <span class=md-ellipsis> Step 3: Target Filtering </span> </a> </li> <li class=md-nav__item> <a href=#step-4-angle-and-distance-calculation class=md-nav__link> <span class=md-ellipsis> Step 4: Angle and Distance Calculation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-integration-with-robot-code class=md-nav__link> <span class=md-ellipsis> 5. Integration with Robot Code </span> </a> <nav class=md-nav aria-label="5. Integration with Robot Code"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#auto-aiming-shooter class=md-nav__link> <span class=md-ellipsis> Auto-Aiming Shooter </span> </a> </li> <li class=md-nav__item> <a href=#vision-assisted-driving class=md-nav__link> <span class=md-ellipsis> Vision-Assisted Driving </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6-real-world-examples class=md-nav__link> <span class=md-ellipsis> 6. Real-World Examples </span> </a> <nav class=md-nav aria-label="6. Real-World Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#apriltag-detection-simple class=md-nav__link> <span class=md-ellipsis> AprilTag Detection (Simple) </span> </a> </li> <li class=md-nav__item> <a href=#game-piece-detection class=md-nav__link> <span class=md-ellipsis> Game Piece Detection </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-performance-optimization class=md-nav__link> <span class=md-ellipsis> 7. Performance Optimization </span> </a> <nav class=md-nav aria-label="7. Performance Optimization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#camera-settings class=md-nav__link> <span class=md-ellipsis> Camera Settings </span> </a> </li> <li class=md-nav__item> <a href=#processing-optimizations class=md-nav__link> <span class=md-ellipsis> Processing Optimizations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#8-debugging-and-tuning class=md-nav__link> <span class=md-ellipsis> 8. Debugging and Tuning </span> </a> <nav class=md-nav aria-label="8. Debugging and Tuning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#essential-telemetry class=md-nav__link> <span class=md-ellipsis> Essential Telemetry </span> </a> </li> <li class=md-nav__item> <a href=#common-issues-solutions class=md-nav__link> <span class=md-ellipsis> Common Issues &amp; Solutions </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#9-practice-project class=md-nav__link> <span class=md-ellipsis> 9. Practice Project </span> </a> </li> <li class=md-nav__item> <a href=#where-to-go-next class=md-nav__link> <span class=md-ellipsis> Where to Go Next </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#1-why-vision-processing class=md-nav__link> <span class=md-ellipsis> 1. Why Vision Processing? </span> </a> <nav class=md-nav aria-label="1. Why Vision Processing?"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-power-of-robot-vision class=md-nav__link> <span class=md-ellipsis> The Power of Robot Vision </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-vision-processing-pipeline class=md-nav__link> <span class=md-ellipsis> 2. Vision Processing Pipeline </span> </a> <nav class=md-nav aria-label="2. Vision Processing Pipeline"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-step-by-step-process class=md-nav__link> <span class=md-ellipsis> The Step-by-Step Process </span> </a> </li> <li class=md-nav__item> <a href=#basic-vision-workflow class=md-nav__link> <span class=md-ellipsis> Basic Vision Workflow </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-vision-architecture-options class=md-nav__link> <span class=md-ellipsis> 3. Vision Architecture Options </span> </a> <nav class=md-nav aria-label="3. Vision Architecture Options"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#option-1-roborio-vision-simplest class=md-nav__link> <span class=md-ellipsis> Option 1: RoboRIO Vision (Simplest) </span> </a> </li> <li class=md-nav__item> <a href=#option-2-coprocessor-vision-recommended class=md-nav__link> <span class=md-ellipsis> Option 2: Coprocessor Vision (Recommended) </span> </a> </li> <li class=md-nav__item> <a href=#option-3-driver-station-vision class=md-nav__link> <span class=md-ellipsis> Option 3: Driver Station Vision </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-basic-vision-pipeline-implementation class=md-nav__link> <span class=md-ellipsis> 4. Basic Vision Pipeline Implementation </span> </a> <nav class=md-nav aria-label="4. Basic Vision Pipeline Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-color-filtering class=md-nav__link> <span class=md-ellipsis> Step 1: Color Filtering </span> </a> </li> <li class=md-nav__item> <a href=#step-2-contour-detection class=md-nav__link> <span class=md-ellipsis> Step 2: Contour Detection </span> </a> </li> <li class=md-nav__item> <a href=#step-3-target-filtering class=md-nav__link> <span class=md-ellipsis> Step 3: Target Filtering </span> </a> </li> <li class=md-nav__item> <a href=#step-4-angle-and-distance-calculation class=md-nav__link> <span class=md-ellipsis> Step 4: Angle and Distance Calculation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-integration-with-robot-code class=md-nav__link> <span class=md-ellipsis> 5. Integration with Robot Code </span> </a> <nav class=md-nav aria-label="5. Integration with Robot Code"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#auto-aiming-shooter class=md-nav__link> <span class=md-ellipsis> Auto-Aiming Shooter </span> </a> </li> <li class=md-nav__item> <a href=#vision-assisted-driving class=md-nav__link> <span class=md-ellipsis> Vision-Assisted Driving </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6-real-world-examples class=md-nav__link> <span class=md-ellipsis> 6. Real-World Examples </span> </a> <nav class=md-nav aria-label="6. Real-World Examples"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#apriltag-detection-simple class=md-nav__link> <span class=md-ellipsis> AprilTag Detection (Simple) </span> </a> </li> <li class=md-nav__item> <a href=#game-piece-detection class=md-nav__link> <span class=md-ellipsis> Game Piece Detection </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-performance-optimization class=md-nav__link> <span class=md-ellipsis> 7. Performance Optimization </span> </a> <nav class=md-nav aria-label="7. Performance Optimization"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#camera-settings class=md-nav__link> <span class=md-ellipsis> Camera Settings </span> </a> </li> <li class=md-nav__item> <a href=#processing-optimizations class=md-nav__link> <span class=md-ellipsis> Processing Optimizations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#8-debugging-and-tuning class=md-nav__link> <span class=md-ellipsis> 8. Debugging and Tuning </span> </a> <nav class=md-nav aria-label="8. Debugging and Tuning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#essential-telemetry class=md-nav__link> <span class=md-ellipsis> Essential Telemetry </span> </a> </li> <li class=md-nav__item> <a href=#common-issues-solutions class=md-nav__link> <span class=md-ellipsis> Common Issues &amp; Solutions </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#9-practice-project class=md-nav__link> <span class=md-ellipsis> 9. Practice Project </span> </a> </li> <li class=md-nav__item> <a href=#where-to-go-next class=md-nav__link> <span class=md-ellipsis> Where to Go Next </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=vision-processing-getting-started>Vision Processing: Getting Started<a class=headerlink href=#vision-processing-getting-started title="Permanent link">&para;</a></h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>Vision processing turns your robot's camera into smart eyes that can recognize targets, track game pieces, and navigate autonomously. Instead of relying solely on sensors, your robot can "see" and react to the field like a human driver - but with perfect consistency.</p> <p><strong>What you'll build:</strong> A robot that can detect and track targets using computer vision for autonomous aiming and navigation.</p> <p><strong>Next steps:</strong> Advanced AprilTag tracking, neural networks, and real-time target recognition using <a href=https://docs.photonvision.org/ >PhotonVision</a> and <a href=https://docs.limelightvision.io/ >LimelightLib</a>.</p> <hr> <h2 id=1-why-vision-processing>1. Why Vision Processing?<a class=headerlink href=#1-why-vision-processing title="Permanent link">&para;</a></h2> <h3 id=the-power-of-robot-vision>The Power of Robot Vision<a class=headerlink href=#the-power-of-robot-vision title="Permanent link">&para;</a></h3> <p><strong>Manual Targeting vs Vision:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1>// Manual: Driver aims manually</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>shooterSubsystem</span><span class=p>.</span><span class=na>setAngle</span><span class=p>(</span><span class=n>driverEstimatedAngle</span><span class=p>);</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=c1>// Vision: Robot automatically finds and tracks target</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=kt>double</span><span class=w> </span><span class=n>targetAngle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vision</span><span class=p>.</span><span class=na>getTargetAngle</span><span class=p>();</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=n>shooterSubsystem</span><span class=p>.</span><span class=na>setAngle</span><span class=p>(</span><span class=n>targetAngle</span><span class=p>);</span>
</code></pre></div></p> <p><strong>Real Benefits:</strong> - <strong>Autonomous scoring</strong> - Perfect aim every time - <strong>Driver assistance</strong> - Help human pilots during teleop - <strong>Game piece detection</strong> - Find balls, cones, cubes automatically - <strong>Navigation aids</strong> - Use field landmarks for positioning - <strong>Consistent performance</strong> - No human error in targeting</p> <p><strong>FRC Applications:</strong> - Auto-aiming for shooters - Autonomous ball collection - Precise docking/charging - Field-relative navigation - Driver camera feeds</p> <hr> <h2 id=2-vision-processing-pipeline>2. Vision Processing Pipeline<a class=headerlink href=#2-vision-processing-pipeline title="Permanent link">&para;</a></h2> <h3 id=the-step-by-step-process>The Step-by-Step Process<a class=headerlink href=#the-step-by-step-process title="Permanent link">&para;</a></h3> <p><strong>1. Image Capture</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>Camera → Raw Image Frame (640x480 pixels, 30 FPS)
</code></pre></div></p> <p><strong>2. Preprocessing</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>Raw Image → Color Space Conversion → Filtered Image
</code></pre></div></p> <p><strong>3. Target Detection</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>Filtered Image → Contour Detection → Target Candidates
</code></pre></div></p> <p><strong>4. Target Analysis</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>Candidates → Filtering → Distance/Angle Calculations
</code></pre></div></p> <p><strong>5. Robot Action</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>Target Data → Robot Code → Motor Commands
</code></pre></div></p> <h3 id=basic-vision-workflow>Basic Vision Workflow<a class=headerlink href=#basic-vision-workflow title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1>// Simplified pipeline</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>robot</span><span class=p>.</span><span class=na>isEnabled</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>    </span><span class=c1>// 1. Capture frame</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>    </span><span class=n>Mat</span><span class=w> </span><span class=n>frame</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>camera</span><span class=p>.</span><span class=na>getFrame</span><span class=p>();</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>    </span><span class=c1>// 2. Filter for target color (e.g., green retroreflective tape)</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>    </span><span class=n>Mat</span><span class=w> </span><span class=n>filtered</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>filterForGreen</span><span class=p>(</span><span class=n>frame</span><span class=p>);</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>    </span><span class=c1>// 3. Find contours (shapes)</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Contour</span><span class=o>&gt;</span><span class=w> </span><span class=n>contours</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>findContours</span><span class=p>(</span><span class=n>filtered</span><span class=p>);</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>    </span><span class=c1>// 4. Filter for target-shaped contours</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Target</span><span class=o>&gt;</span><span class=w> </span><span class=n>targets</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>filterTargets</span><span class=p>(</span><span class=n>contours</span><span class=p>);</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>    </span><span class=c1>// 5. Use best target for robot control</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>targets</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>        </span><span class=n>Target</span><span class=w> </span><span class=n>best</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getBestTarget</span><span class=p>(</span><span class=n>targets</span><span class=p>);</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>angle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calculateAngle</span><span class=p>(</span><span class=n>best</span><span class=p>);</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>        </span><span class=n>robotCode</span><span class=p>.</span><span class=na>setTargetAngle</span><span class=p>(</span><span class=n>angle</span><span class=p>);</span>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=p>}</span>
</code></pre></div> <hr> <h2 id=3-vision-architecture-options>3. Vision Architecture Options<a class=headerlink href=#3-vision-architecture-options title="Permanent link">&para;</a></h2> <h3 id=option-1-roborio-vision-simplest>Option 1: RoboRIO Vision (Simplest)<a class=headerlink href=#option-1-roborio-vision-simplest title="Permanent link">&para;</a></h3> <p><strong>Setup:</strong> Camera → RoboRIO → Robot Code</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>VisionSubsystem</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>SubsystemBase</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>UsbCamera</span><span class=w> </span><span class=n>camera</span><span class=p>;</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>CvSink</span><span class=w> </span><span class=n>cvSink</span><span class=p>;</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Mat</span><span class=w> </span><span class=n>frame</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Mat</span><span class=p>();</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>VisionSubsystem</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>        </span><span class=c1>// Camera setup on roboRIO</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>        </span><span class=n>camera</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CameraServer</span><span class=p>.</span><span class=na>startAutomaticCapture</span><span class=p>();</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=w>        </span><span class=n>camera</span><span class=p>.</span><span class=na>setResolution</span><span class=p>(</span><span class=mi>320</span><span class=p>,</span><span class=w> </span><span class=mi>240</span><span class=p>);</span><span class=w>  </span><span class=c1>// Lower resolution for performance</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>        </span><span class=n>camera</span><span class=p>.</span><span class=na>setFPS</span><span class=p>(</span><span class=mi>15</span><span class=p>);</span><span class=w>               </span><span class=c1>// Lower FPS for roboRIO</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=w>        </span><span class=n>cvSink</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CameraServer</span><span class=p>.</span><span class=na>getVideo</span><span class=p>();</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=w>    </span><span class=nd>@Override</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>periodic</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=w>        </span><span class=c1>// Grab frame (non-blocking)</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>cvSink</span><span class=p>.</span><span class=na>grabFrame</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=w>            </span><span class=k>return</span><span class=p>;</span><span class=w> </span><span class=c1>// No new frame</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=w>        </span><span class=c1>// Process frame</span>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=w>        </span><span class=n>processFrame</span><span class=p>(</span><span class=n>frame</span><span class=p>);</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>processFrame</span><span class=p>(</span><span class=n>Mat</span><span class=w> </span><span class=n>frame</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a><span class=w>        </span><span class=c1>// Your vision pipeline here</span>
<a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Target</span><span class=o>&gt;</span><span class=w> </span><span class=n>targets</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>visionPipeline</span><span class=p>.</span><span class=na>process</span><span class=p>(</span><span class=n>frame</span><span class=p>);</span>
<a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>
<a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a><span class=w>        </span><span class=c1>// Send results to robot</span>
<a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>targets</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a><span class=w>            </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Target Angle&quot;</span><span class=p>,</span><span class=w> </span><span class=n>targets</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=mi>0</span><span class=p>).</span><span class=na>angle</span><span class=p>);</span>
<a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a><span class=p>}</span>
</code></pre></div> <p><strong>Pros:</strong> Simple, everything in one place <strong>Cons:</strong> Limited processing power, can slow robot code</p> <h3 id=option-2-coprocessor-vision-recommended>Option 2: Coprocessor Vision (Recommended)<a class=headerlink href=#option-2-coprocessor-vision-recommended title="Permanent link">&para;</a></h3> <p><strong>Setup:</strong> Camera → Raspberry Pi/Jetson → NetworkTables → RoboRIO</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c1># Python vision code on Raspberry Pi</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>import</span><span class=w> </span><span class=nn>cv2</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=kn>from</span><span class=w> </span><span class=nn>networktables</span><span class=w> </span><span class=kn>import</span> <span class=n>NetworkTables</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=c1># Initialize NetworkTables</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=n>NetworkTables</span><span class=o>.</span><span class=n>initialize</span><span class=p>(</span><span class=n>server</span><span class=o>=</span><span class=s1>&#39;10.TE.AM.2&#39;</span><span class=p>)</span>  <span class=c1># Your robot IP</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=n>vision_table</span> <span class=o>=</span> <span class=n>NetworkTables</span><span class=o>.</span><span class=n>getTable</span><span class=p>(</span><span class=s1>&#39;vision&#39;</span><span class=p>)</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=c1># Camera setup</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=n>camera</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>VideoCapture</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=n>camera</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>CAP_PROP_FRAME_WIDTH</span><span class=p>,</span> <span class=mi>640</span><span class=p>)</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=n>camera</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>cv2</span><span class=o>.</span><span class=n>CAP_PROP_FRAME_HEIGHT</span><span class=p>,</span> <span class=mi>480</span><span class=p>)</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>    <span class=n>ret</span><span class=p>,</span> <span class=n>frame</span> <span class=o>=</span> <span class=n>camera</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>ret</span><span class=p>:</span>
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>        <span class=k>continue</span>
<a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>
<a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>    <span class=c1># Vision pipeline</span>
<a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>    <span class=n>targets</span> <span class=o>=</span> <span class=n>process_frame</span><span class=p>(</span><span class=n>frame</span><span class=p>)</span>
<a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>
<a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>    <span class=c1># Send to robot</span>
<a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>    <span class=k>if</span> <span class=n>targets</span><span class=p>:</span>
<a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a>        <span class=n>best_target</span> <span class=o>=</span> <span class=n>targets</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a>        <span class=n>vision_table</span><span class=o>.</span><span class=n>putNumber</span><span class=p>(</span><span class=s1>&#39;target_angle&#39;</span><span class=p>,</span> <span class=n>best_target</span><span class=o>.</span><span class=n>angle</span><span class=p>)</span>
<a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>        <span class=n>vision_table</span><span class=o>.</span><span class=n>putNumber</span><span class=p>(</span><span class=s1>&#39;target_distance&#39;</span><span class=p>,</span> <span class=n>best_target</span><span class=o>.</span><span class=n>distance</span><span class=p>)</span>
<a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a>        <span class=n>vision_table</span><span class=o>.</span><span class=n>putBoolean</span><span class=p>(</span><span class=s1>&#39;target_found&#39;</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span>
<a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>        <span class=n>vision_table</span><span class=o>.</span><span class=n>putBoolean</span><span class=p>(</span><span class=s1>&#39;target_found&#39;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1>// Robot code receives vision data</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ShooterSubsystem</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>SubsystemBase</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>NetworkTableEntry</span><span class=w> </span><span class=n>targetAngle</span><span class=p>;</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>NetworkTableEntry</span><span class=w> </span><span class=n>targetFound</span><span class=p>;</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>ShooterSubsystem</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>        </span><span class=n>NetworkTable</span><span class=w> </span><span class=n>visionTable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>NetworkTableInstance</span><span class=p>.</span><span class=na>getDefault</span><span class=p>().</span><span class=na>getTable</span><span class=p>(</span><span class=s>&quot;vision&quot;</span><span class=p>);</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>        </span><span class=n>targetAngle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>visionTable</span><span class=p>.</span><span class=na>getEntry</span><span class=p>(</span><span class=s>&quot;target_angle&quot;</span><span class=p>);</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>        </span><span class=n>targetFound</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>visionTable</span><span class=p>.</span><span class=na>getEntry</span><span class=p>(</span><span class=s>&quot;target_found&quot;</span><span class=p>);</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>hasTarget</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>targetFound</span><span class=p>.</span><span class=na>getBoolean</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=nf>getTargetAngle</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>targetAngle</span><span class=p>.</span><span class=na>getDouble</span><span class=p>(</span><span class=mf>0.0</span><span class=p>);</span>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=p>}</span>
</code></pre></div> <p><strong>Pros:</strong> Fast processing, doesn't slow robot code <strong>Cons:</strong> More complex setup, additional hardware</p> <h3 id=option-3-driver-station-vision>Option 3: Driver Station Vision<a class=headerlink href=#option-3-driver-station-vision title="Permanent link">&para;</a></h3> <p><strong>Setup:</strong> Camera → RoboRIO → Driver Station → NetworkTables → Robot</p> <p><strong>Pros:</strong> Powerful laptop processing <strong>Cons:</strong> High latency, bandwidth limitations</p> <hr> <h2 id=4-basic-vision-pipeline-implementation>4. Basic Vision Pipeline Implementation<a class=headerlink href=#4-basic-vision-pipeline-implementation title="Permanent link">&para;</a></h2> <h3 id=step-1-color-filtering>Step 1: Color Filtering<a class=headerlink href=#step-1-color-filtering title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>VisionPipeline</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>    </span><span class=c1>// HSV ranges for green retroreflective tape</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Scalar</span><span class=w> </span><span class=n>lowerGreen</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Scalar</span><span class=p>(</span><span class=mi>40</span><span class=p>,</span><span class=w> </span><span class=mi>50</span><span class=p>,</span><span class=w> </span><span class=mi>50</span><span class=p>);</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Scalar</span><span class=w> </span><span class=n>upperGreen</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Scalar</span><span class=p>(</span><span class=mi>80</span><span class=p>,</span><span class=w> </span><span class=mi>255</span><span class=p>,</span><span class=w> </span><span class=mi>255</span><span class=p>);</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Mat</span><span class=w> </span><span class=nf>filterForTarget</span><span class=p>(</span><span class=n>Mat</span><span class=w> </span><span class=n>input</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>        </span><span class=n>Mat</span><span class=w> </span><span class=n>hsv</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Mat</span><span class=p>();</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>        </span><span class=n>Mat</span><span class=w> </span><span class=n>mask</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Mat</span><span class=p>();</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>        </span><span class=c1>// Convert to HSV color space</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>        </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>cvtColor</span><span class=p>(</span><span class=n>input</span><span class=p>,</span><span class=w> </span><span class=n>hsv</span><span class=p>,</span><span class=w> </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>COLOR_BGR2HSV</span><span class=p>);</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=w>        </span><span class=c1>// Filter for green color</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>        </span><span class=n>Core</span><span class=p>.</span><span class=na>inRange</span><span class=p>(</span><span class=n>hsv</span><span class=p>,</span><span class=w> </span><span class=n>lowerGreen</span><span class=p>,</span><span class=w> </span><span class=n>upperGreen</span><span class=p>,</span><span class=w> </span><span class=n>mask</span><span class=p>);</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=w>        </span><span class=c1>// Clean up noise</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=w>        </span><span class=n>Mat</span><span class=w> </span><span class=n>kernel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>getStructuringElement</span><span class=p>(</span><span class=n>Imgproc</span><span class=p>.</span><span class=na>MORPH_RECT</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Size</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>));</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=w>        </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>morphologyEx</span><span class=p>(</span><span class=n>mask</span><span class=p>,</span><span class=w> </span><span class=n>mask</span><span class=p>,</span><span class=w> </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>MORPH_OPEN</span><span class=p>,</span><span class=w> </span><span class=n>kernel</span><span class=p>);</span>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=w>        </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>morphologyEx</span><span class=p>(</span><span class=n>mask</span><span class=p>,</span><span class=w> </span><span class=n>mask</span><span class=p>,</span><span class=w> </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>MORPH_CLOSE</span><span class=p>,</span><span class=w> </span><span class=n>kernel</span><span class=p>);</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>mask</span><span class=p>;</span>
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=p>}</span>
</code></pre></div> <h3 id=step-2-contour-detection>Step 2: Contour Detection<a class=headerlink href=#step-2-contour-detection title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kd>public</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>MatOfPoint</span><span class=o>&gt;</span><span class=w> </span><span class=nf>findContours</span><span class=p>(</span><span class=n>Mat</span><span class=w> </span><span class=n>mask</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>MatOfPoint</span><span class=o>&gt;</span><span class=w> </span><span class=n>contours</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=w>    </span><span class=n>Mat</span><span class=w> </span><span class=n>hierarchy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Mat</span><span class=p>();</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span><span class=c1>// Find contours</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>findContours</span><span class=p>(</span><span class=n>mask</span><span class=p>,</span><span class=w> </span><span class=n>contours</span><span class=p>,</span><span class=w> </span><span class=n>hierarchy</span><span class=p>,</span><span class=w> </span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>                        </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>RETR_EXTERNAL</span><span class=p>,</span><span class=w> </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>CHAIN_APPROX_SIMPLE</span><span class=p>);</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>contours</span><span class=p>;</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=p>}</span>
</code></pre></div> <h3 id=step-3-target-filtering>Step 3: Target Filtering<a class=headerlink href=#step-3-target-filtering title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Target</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>centerX</span><span class=p>;</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>centerY</span><span class=p>;</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>area</span><span class=p>;</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>angle</span><span class=p>;</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>distance</span><span class=p>;</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=p>}</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=kd>public</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Target</span><span class=o>&gt;</span><span class=w> </span><span class=nf>filterTargets</span><span class=p>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>MatOfPoint</span><span class=o>&gt;</span><span class=w> </span><span class=n>contours</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Target</span><span class=o>&gt;</span><span class=w> </span><span class=n>targets</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a>
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>MatOfPoint</span><span class=w> </span><span class=n>contour</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>contours</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>area</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>contourArea</span><span class=p>(</span><span class=n>contour</span><span class=p>);</span>
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>
<a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=w>        </span><span class=c1>// Filter by size</span>
<a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>area</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>area</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10000</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=w>            </span><span class=k>continue</span><span class=p>;</span>
<a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a>
<a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=w>        </span><span class=c1>// Get bounding rectangle</span>
<a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a><span class=w>        </span><span class=n>Rect</span><span class=w> </span><span class=n>boundingRect</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Imgproc</span><span class=p>.</span><span class=na>boundingRect</span><span class=p>(</span><span class=n>contour</span><span class=p>);</span>
<a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>aspectRatio</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=w> </span><span class=n>boundingRect</span><span class=p>.</span><span class=na>width</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>boundingRect</span><span class=p>.</span><span class=na>height</span><span class=p>;</span>
<a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a>
<a id=__codelineno-12-24 name=__codelineno-12-24 href=#__codelineno-12-24></a><span class=w>        </span><span class=c1>// Filter by aspect ratio (targets are typically wider than tall)</span>
<a id=__codelineno-12-25 name=__codelineno-12-25 href=#__codelineno-12-25></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>aspectRatio</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mf>1.2</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>aspectRatio</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mf>3.0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-12-26 name=__codelineno-12-26 href=#__codelineno-12-26></a><span class=w>            </span><span class=k>continue</span><span class=p>;</span>
<a id=__codelineno-12-27 name=__codelineno-12-27 href=#__codelineno-12-27></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-12-28 name=__codelineno-12-28 href=#__codelineno-12-28></a>
<a id=__codelineno-12-29 name=__codelineno-12-29 href=#__codelineno-12-29></a><span class=w>        </span><span class=c1>// Create target object</span>
<a id=__codelineno-12-30 name=__codelineno-12-30 href=#__codelineno-12-30></a><span class=w>        </span><span class=n>Target</span><span class=w> </span><span class=n>target</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Target</span><span class=p>();</span>
<a id=__codelineno-12-31 name=__codelineno-12-31 href=#__codelineno-12-31></a><span class=w>        </span><span class=n>target</span><span class=p>.</span><span class=na>centerX</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>boundingRect</span><span class=p>.</span><span class=na>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>boundingRect</span><span class=p>.</span><span class=na>width</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>2.0</span><span class=p>;</span>
<a id=__codelineno-12-32 name=__codelineno-12-32 href=#__codelineno-12-32></a><span class=w>        </span><span class=n>target</span><span class=p>.</span><span class=na>centerY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>boundingRect</span><span class=p>.</span><span class=na>y</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>boundingRect</span><span class=p>.</span><span class=na>height</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>2.0</span><span class=p>;</span>
<a id=__codelineno-12-33 name=__codelineno-12-33 href=#__codelineno-12-33></a><span class=w>        </span><span class=n>target</span><span class=p>.</span><span class=na>area</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>area</span><span class=p>;</span>
<a id=__codelineno-12-34 name=__codelineno-12-34 href=#__codelineno-12-34></a>
<a id=__codelineno-12-35 name=__codelineno-12-35 href=#__codelineno-12-35></a><span class=w>        </span><span class=n>targets</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>target</span><span class=p>);</span>
<a id=__codelineno-12-36 name=__codelineno-12-36 href=#__codelineno-12-36></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-12-37 name=__codelineno-12-37 href=#__codelineno-12-37></a>
<a id=__codelineno-12-38 name=__codelineno-12-38 href=#__codelineno-12-38></a><span class=w>    </span><span class=c1>// Sort by area (biggest first)</span>
<a id=__codelineno-12-39 name=__codelineno-12-39 href=#__codelineno-12-39></a><span class=w>    </span><span class=n>targets</span><span class=p>.</span><span class=na>sort</span><span class=p>((</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>Double</span><span class=p>.</span><span class=na>compare</span><span class=p>(</span><span class=n>b</span><span class=p>.</span><span class=na>area</span><span class=p>,</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=na>area</span><span class=p>));</span>
<a id=__codelineno-12-40 name=__codelineno-12-40 href=#__codelineno-12-40></a>
<a id=__codelineno-12-41 name=__codelineno-12-41 href=#__codelineno-12-41></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>targets</span><span class=p>;</span>
<a id=__codelineno-12-42 name=__codelineno-12-42 href=#__codelineno-12-42></a><span class=p>}</span>
</code></pre></div> <h3 id=step-4-angle-and-distance-calculation>Step 4: Angle and Distance Calculation<a class=headerlink href=#step-4-angle-and-distance-calculation title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>calculateTargetInfo</span><span class=p>(</span><span class=n>Target</span><span class=w> </span><span class=n>target</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>imageWidth</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>imageHeight</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>    </span><span class=c1>// Camera parameters (calibrate these for your camera)</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>focalLength</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>300</span><span class=p>;</span><span class=w>  </span><span class=c1>// pixels</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>targetWidth</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>14.5</span><span class=p>;</span><span class=w> </span><span class=c1>// inches (actual target width)</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=w>    </span><span class=c1>// Calculate horizontal angle</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>centerX</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>imageWidth</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>2.0</span><span class=p>;</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>pixelError</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>target</span><span class=p>.</span><span class=na>centerX</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>centerX</span><span class=p>;</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=w>    </span><span class=n>target</span><span class=p>.</span><span class=na>angle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>atan</span><span class=p>(</span><span class=n>pixelError</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>focalLength</span><span class=p>);</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=w>    </span><span class=c1>// Estimate distance (rough approximation)</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>targetPixelWidth</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>sqrt</span><span class=p>(</span><span class=n>target</span><span class=p>.</span><span class=na>area</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>);</span><span class=w> </span><span class=c1>// Approximate width</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=w>    </span><span class=n>target</span><span class=p>.</span><span class=na>distance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>targetWidth</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>focalLength</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>targetPixelWidth</span><span class=p>;</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=p>}</span>
</code></pre></div> <hr> <h2 id=5-integration-with-robot-code>5. Integration with Robot Code<a class=headerlink href=#5-integration-with-robot-code title="Permanent link">&para;</a></h2> <h3 id=auto-aiming-shooter>Auto-Aiming Shooter<a class=headerlink href=#auto-aiming-shooter title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>AutoAimCommand</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>CommandBase</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ShooterSubsystem</span><span class=w> </span><span class=n>shooter</span><span class=p>;</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>VisionSubsystem</span><span class=w> </span><span class=n>vision</span><span class=p>;</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>PIDController</span><span class=w> </span><span class=n>turnController</span><span class=p>;</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>AutoAimCommand</span><span class=p>(</span><span class=n>ShooterSubsystem</span><span class=w> </span><span class=n>shooter</span><span class=p>,</span><span class=w> </span><span class=n>VisionSubsystem</span><span class=w> </span><span class=n>vision</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>shooter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>shooter</span><span class=p>;</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>vision</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vision</span><span class=p>;</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>turnController</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>PIDController</span><span class=p>(</span><span class=mf>0.1</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.01</span><span class=p>);</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=w>        </span><span class=n>addRequirements</span><span class=p>(</span><span class=n>shooter</span><span class=p>);</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=w>    </span><span class=nd>@Override</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>execute</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>vision</span><span class=p>.</span><span class=na>hasTarget</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=w>            </span><span class=kt>double</span><span class=w> </span><span class=n>targetAngle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vision</span><span class=p>.</span><span class=na>getTargetAngle</span><span class=p>();</span>
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=w>            </span><span class=kt>double</span><span class=w> </span><span class=n>output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>turnController</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>targetAngle</span><span class=p>);</span><span class=w> </span><span class=c1>// Want angle error to be 0</span>
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=w>            </span><span class=n>shooter</span><span class=p>.</span><span class=na>setTurretSpeed</span><span class=p>(</span><span class=n>output</span><span class=p>);</span>
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>            </span><span class=n>shooter</span><span class=p>.</span><span class=na>setTurretSpeed</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
<a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a>
<a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a><span class=w>    </span><span class=nd>@Override</span>
<a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>isFinished</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>vision</span><span class=p>.</span><span class=na>hasTarget</span><span class=p>()</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>abs</span><span class=p>(</span><span class=n>vision</span><span class=p>.</span><span class=na>getTargetAngle</span><span class=p>())</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mf>0.05</span><span class=p>;</span><span class=w> </span><span class=c1>// Within tolerance</span>
<a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a><span class=p>}</span>
</code></pre></div> <h3 id=vision-assisted-driving>Vision-Assisted Driving<a class=headerlink href=#vision-assisted-driving title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DriveWithVisionAssist</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>CommandBase</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>SwerveDrive</span><span class=w> </span><span class=n>drive</span><span class=p>;</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>VisionSubsystem</span><span class=w> </span><span class=n>vision</span><span class=p>;</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>XboxController</span><span class=w> </span><span class=n>controller</span><span class=p>;</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>    </span><span class=nd>@Override</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>execute</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=w>        </span><span class=c1>// Get driver input</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>xSpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>controller</span><span class=p>.</span><span class=na>getLeftY</span><span class=p>();</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>ySpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>controller</span><span class=p>.</span><span class=na>getLeftX</span><span class=p>();</span>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>rotation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>controller</span><span class=p>.</span><span class=na>getRightX</span><span class=p>();</span>
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=w>        </span><span class=c1>// Add vision assist for rotation</span>
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>controller</span><span class=p>.</span><span class=na>getAButton</span><span class=p>()</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>vision</span><span class=p>.</span><span class=na>hasTarget</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a><span class=w>            </span><span class=kt>double</span><span class=w> </span><span class=n>visionCorrection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>vision</span><span class=p>.</span><span class=na>getTargetAngle</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>0.1</span><span class=p>;</span><span class=w> </span><span class=c1>// Gentle assist</span>
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=w>            </span><span class=n>rotation</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>visionCorrection</span><span class=p>;</span>
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a>
<a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a><span class=w>        </span><span class=n>ChassisSpeeds</span><span class=w> </span><span class=n>speeds</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ChassisSpeeds</span><span class=p>(</span><span class=n>xSpeed</span><span class=p>,</span><span class=w> </span><span class=n>ySpeed</span><span class=p>,</span><span class=w> </span><span class=n>rotation</span><span class=p>);</span>
<a id=__codelineno-15-20 name=__codelineno-15-20 href=#__codelineno-15-20></a><span class=w>        </span><span class=n>drive</span><span class=p>.</span><span class=na>drive</span><span class=p>(</span><span class=n>speeds</span><span class=p>);</span>
<a id=__codelineno-15-21 name=__codelineno-15-21 href=#__codelineno-15-21></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-15-22 name=__codelineno-15-22 href=#__codelineno-15-22></a><span class=p>}</span>
</code></pre></div> <hr> <h2 id=6-real-world-examples>6. Real-World Examples<a class=headerlink href=#6-real-world-examples title="Permanent link">&para;</a></h2> <h3 id=apriltag-detection-simple>AprilTag Detection (Simple)<a class=headerlink href=#apriltag-detection-simple title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=c1>// Using WPILib&#39;s AprilTag detector</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=n>AprilTagDetector</span><span class=w> </span><span class=n>detector</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>AprilTagDetector</span><span class=p>();</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=n>detector</span><span class=p>.</span><span class=na>addFamily</span><span class=p>(</span><span class=n>AprilTagFamily</span><span class=p>.</span><span class=na>TAG_16h5</span><span class=p>);</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>processAprilTags</span><span class=p>(</span><span class=n>Mat</span><span class=w> </span><span class=n>frame</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>    </span><span class=n>AprilTagDetection</span><span class=o>[]</span><span class=w> </span><span class=n>detections</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>detector</span><span class=p>.</span><span class=na>detect</span><span class=p>(</span><span class=n>frame</span><span class=p>);</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>AprilTagDetection</span><span class=w> </span><span class=n>detection</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>detections</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>tagID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>detection</span><span class=p>.</span><span class=na>getId</span><span class=p>();</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=w>        </span><span class=n>Pose3d</span><span class=w> </span><span class=n>tagPose</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>detection</span><span class=p>.</span><span class=na>getPose</span><span class=p>();</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=w>        </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Tag &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tagID</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot; X&quot;</span><span class=p>,</span><span class=w> </span><span class=n>tagPose</span><span class=p>.</span><span class=na>getX</span><span class=p>());</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=w>        </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Tag &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tagID</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot; Y&quot;</span><span class=p>,</span><span class=w> </span><span class=n>tagPose</span><span class=p>.</span><span class=na>getY</span><span class=p>());</span>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=p>}</span>
</code></pre></div> <h3 id=game-piece-detection>Game Piece Detection<a class=headerlink href=#game-piece-detection title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=c1># Detect orange balls/cones</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=k>def</span><span class=w> </span><span class=nf>detect_game_pieces</span><span class=p>(</span><span class=n>frame</span><span class=p>):</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a>    <span class=n>hsv</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>cvtColor</span><span class=p>(</span><span class=n>frame</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>COLOR_BGR2HSV</span><span class=p>)</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>    <span class=c1># Orange color range</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>    <span class=n>lower_orange</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>10</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>100</span><span class=p>])</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a>    <span class=n>upper_orange</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>20</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mi>255</span><span class=p>])</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a>    <span class=n>mask</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>inRange</span><span class=p>(</span><span class=n>hsv</span><span class=p>,</span> <span class=n>lower_orange</span><span class=p>,</span> <span class=n>upper_orange</span><span class=p>)</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>    <span class=n>contours</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>findContours</span><span class=p>(</span><span class=n>mask</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>RETR_EXTERNAL</span><span class=p>,</span> <span class=n>cv2</span><span class=o>.</span><span class=n>CHAIN_APPROX_SIMPLE</span><span class=p>)</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>    <span class=n>game_pieces</span> <span class=o>=</span> <span class=p>[]</span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a>    <span class=k>for</span> <span class=n>contour</span> <span class=ow>in</span> <span class=n>contours</span><span class=p>:</span>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>        <span class=n>area</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>contourArea</span><span class=p>(</span><span class=n>contour</span><span class=p>)</span>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a>        <span class=k>if</span> <span class=n>area</span> <span class=o>&gt;</span> <span class=mi>500</span><span class=p>:</span>  <span class=c1># Filter small detections</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>            <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>h</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>boundingRect</span><span class=p>(</span><span class=n>contour</span><span class=p>)</span>
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>            <span class=n>center_x</span> <span class=o>=</span> <span class=n>x</span> <span class=o>+</span> <span class=n>w</span> <span class=o>//</span> <span class=mi>2</span>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>            <span class=n>center_y</span> <span class=o>=</span> <span class=n>y</span> <span class=o>+</span> <span class=n>h</span> <span class=o>//</span> <span class=mi>2</span>
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a>            <span class=n>game_pieces</span><span class=o>.</span><span class=n>append</span><span class=p>({</span><span class=s1>&#39;x&#39;</span><span class=p>:</span> <span class=n>center_x</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>:</span> <span class=n>center_y</span><span class=p>,</span> <span class=s1>&#39;area&#39;</span><span class=p>:</span> <span class=n>area</span><span class=p>})</span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a>
<a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a>    <span class=k>return</span> <span class=n>game_pieces</span>
</code></pre></div> <hr> <h2 id=7-performance-optimization>7. Performance Optimization<a class=headerlink href=#7-performance-optimization title="Permanent link">&para;</a></h2> <h3 id=camera-settings>Camera Settings<a class=headerlink href=#camera-settings title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1>// Optimize for performance</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=n>camera</span><span class=p>.</span><span class=na>setResolution</span><span class=p>(</span><span class=mi>320</span><span class=p>,</span><span class=w> </span><span class=mi>240</span><span class=p>);</span><span class=w>  </span><span class=c1>// Lower resolution = faster processing</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=n>camera</span><span class=p>.</span><span class=na>setFPS</span><span class=p>(</span><span class=mi>15</span><span class=p>);</span><span class=w>               </span><span class=c1>// 15 FPS often sufficient</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=n>camera</span><span class=p>.</span><span class=na>setExposure</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span><span class=w>           </span><span class=c1>// Auto exposure off for consistent lighting</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=n>camera</span><span class=p>.</span><span class=na>setBrightness</span><span class=p>(</span><span class=mi>30</span><span class=p>);</span><span class=w>        </span><span class=c1>// Adjust for your field conditions</span>
</code></pre></div> <h3 id=processing-optimizations>Processing Optimizations<a class=headerlink href=#processing-optimizations title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1>// Process every other frame for performance</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>frameCount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=nd>@Override</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>periodic</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>    </span><span class=n>frameCount</span><span class=o>++</span><span class=p>;</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>frameCount</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>  </span><span class=c1>// Process every other frame</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>        </span><span class=n>processFrame</span><span class=p>();</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=p>}</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=c1>// Region of Interest (ROI) processing</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=kd>public</span><span class=w> </span><span class=n>Mat</span><span class=w> </span><span class=nf>getROI</span><span class=p>(</span><span class=n>Mat</span><span class=w> </span><span class=n>frame</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>    </span><span class=c1>// Only process center portion where targets likely appear</span>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>frame</span><span class=p>.</span><span class=na>width</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>4</span><span class=p>;</span>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>frame</span><span class=p>.</span><span class=na>height</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>4</span><span class=p>;</span>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>frame</span><span class=p>.</span><span class=na>width</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>frame</span><span class=p>.</span><span class=na>height</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=w>    </span><span class=n>Rect</span><span class=w> </span><span class=n>roi</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Rect</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>height</span><span class=p>);</span>
<a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Mat</span><span class=p>(</span><span class=n>frame</span><span class=p>,</span><span class=w> </span><span class=n>roi</span><span class=p>);</span>
<a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=p>}</span>
</code></pre></div> <hr> <h2 id=8-debugging-and-tuning>8. Debugging and Tuning<a class=headerlink href=#8-debugging-and-tuning title="Permanent link">&para;</a></h2> <h3 id=essential-telemetry>Essential Telemetry<a class=headerlink href=#essential-telemetry title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=nd>@Override</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>periodic</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>    </span><span class=c1>// Camera info</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>    </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Camera FPS&quot;</span><span class=p>,</span><span class=w> </span><span class=n>camera</span><span class=p>.</span><span class=na>getActualFPS</span><span class=p>());</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=w>    </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putBoolean</span><span class=p>(</span><span class=s>&quot;Camera Connected&quot;</span><span class=p>,</span><span class=w> </span><span class=n>camera</span><span class=p>.</span><span class=na>isConnected</span><span class=p>());</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=w>    </span><span class=c1>// Vision results</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=w>    </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putBoolean</span><span class=p>(</span><span class=s>&quot;Target Found&quot;</span><span class=p>,</span><span class=w> </span><span class=n>hasTarget</span><span class=p>());</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=w>    </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Target Count&quot;</span><span class=p>,</span><span class=w> </span><span class=n>targets</span><span class=p>.</span><span class=na>size</span><span class=p>());</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>hasTarget</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=w>        </span><span class=n>Target</span><span class=w> </span><span class=n>best</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getBestTarget</span><span class=p>();</span>
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a><span class=w>        </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Target Angle&quot;</span><span class=p>,</span><span class=w> </span><span class=n>best</span><span class=p>.</span><span class=na>angle</span><span class=p>);</span>
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a><span class=w>        </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Target Distance&quot;</span><span class=p>,</span><span class=w> </span><span class=n>best</span><span class=p>.</span><span class=na>distance</span><span class=p>);</span>
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a><span class=w>        </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Target Area&quot;</span><span class=p>,</span><span class=w> </span><span class=n>best</span><span class=p>.</span><span class=na>area</span><span class=p>);</span>
<a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a>
<a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a><span class=w>    </span><span class=c1>// Performance monitoring</span>
<a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a><span class=w>    </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Processing Time&quot;</span><span class=p>,</span><span class=w> </span><span class=n>processingTimeMs</span><span class=p>);</span>
<a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a><span class=p>}</span>
</code></pre></div> <h3 id=common-issues-solutions>Common Issues &amp; Solutions<a class=headerlink href=#common-issues-solutions title="Permanent link">&para;</a></h3> <p><strong>Problem:</strong> No targets detected - <strong>Solution:</strong> Check color ranges, lighting conditions, camera exposure</p> <p><strong>Problem:</strong> False positive detections - <strong>Solution:</strong> Tighten filtering criteria (area, aspect ratio, etc.)</p> <p><strong>Problem:</strong> Intermittent target loss - <strong>Solution:</strong> Add target tracking/prediction, improve filtering</p> <p><strong>Problem:</strong> Poor performance/lag - <strong>Solution:</strong> Lower resolution/FPS, optimize pipeline, use coprocessor</p> <p><strong>Problem:</strong> Inaccurate distance measurements - <strong>Solution:</strong> Calibrate camera, use stereo vision, add known target size</p> <hr> <h2 id=9-practice-project>9. Practice Project<a class=headerlink href=#9-practice-project title="Permanent link">&para;</a></h2> <p><strong>Build this step-by-step:</strong></p> <ol> <li><strong>Camera Setup</strong> - Get camera streaming to dashboard</li> <li><strong>Basic Detection</strong> - Detect simple colored objects</li> <li><strong>Target Filtering</strong> - Filter by size and shape</li> <li><strong>Angle Calculation</strong> - Calculate target angle from center</li> <li><strong>Robot Integration</strong> - Use vision data to control robot</li> <li><strong>Auto-Aiming</strong> - Create automatic targeting system</li> </ol> <p><strong>Success Criteria:</strong> - Consistent target detection under field lighting - Accurate angle calculations within 2-3 degrees - Smooth auto-aiming without oscillation - Good performance (&gt;10 FPS processing)</p> <hr> <h2 id=where-to-go-next>Where to Go Next<a class=headerlink href=#where-to-go-next title="Permanent link">&para;</a></h2> <p><strong>Ready for professional vision? Explore these:</strong></p> <p><strong>🎯 Pre-Built Solutions</strong> - <a href=https://docs.photonvision.org/ >PhotonVision</a> - Complete vision processing suite - <a href=https://docs.limelightvision.io/ >LimelightLib</a> - Plug-and-play vision computer - <a href=https://chameleon-vision.readthedocs.io/ >Chameleon Vision</a> - Open-source vision processing</p> <p><strong>🔧 Advanced Techniques</strong> - <a href=https://docs.opencv.org/4.x/dc/dbb/tutorial_py_calibration.html>Camera Calibration</a> - Accurate 3D positioning - <a href=https://docs.wpilib.org/en/stable/docs/software/vision-processing/apriltag/apriltag-intro.html>Pose Estimation</a> - 6DOF target tracking - <a href=https://www.tensorflow.org/ >Machine Learning</a> - Neural network object detection</p> <p><strong>📊 Multi-Camera Systems</strong> - <a href=https://docs.opencv.org/4.x/dd/d53/tutorial_py_depthmap.html>Stereo Vision</a> - Depth perception - <a href=https://docs.photonvision.org/en/latest/docs/programming/photonlib/getting-target-data.html>360° Coverage</a> - Multiple camera coordination</p> <p><strong>⚡ Real-Time Performance</strong> - <a href=https://opencv.org/platforms/cuda/ >GPU Acceleration</a> - CUDA-accelerated processing - <a href=https://www.ni.com/en-us/shop/labview/add-ons/third-party/ni-vision-for-labview.html>FPGA Vision</a> - Ultra-low latency processing</p> <hr> <p><strong>🚀 Ready to give your robot eyes?</strong> Start with basic color detection, master the fundamentals, then explore professional vision solutions for competition-winning autonomous performance!</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 6, 2025 13:17:30 UTC">August 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 6, 2025 13:17:30 UTC">August 6, 2025</span> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by using our <a href=... target=_blank rel=noopener>feedback form</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.sections", "navigation.expand", "navigation.tracking"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.13a4f30d.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/clike/clike.min.js></script> <script src=../../../js/pid-simulator.js></script> </body> </html>