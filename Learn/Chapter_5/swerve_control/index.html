<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://frccode.github.io/Learn/Chapter_5/swerve_control/ rel=canonical><link href=../simple_trajectories/ rel=prev><link href=../../Chapter_6/auto_strategy/ rel=next><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>Swerve Drive Programming Guide - FRCCode.org</title><link rel=stylesheet href=../../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/material.min.css><link rel=stylesheet href=../../../css/pid-simulator.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#swerve-drive-programming-guide class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=FRCCode.org class="md-header__button md-logo" aria-label=FRCCode.org data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> FRCCode.org </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Swerve Drive Programming Guide </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/frccode/frccode title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> frccode/frccode </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> FRCCode </a> </li> <li class=md-tabs__item> <a href=../../../support_and_help/ class=md-tabs__link> Support &amp; Help </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../Chapter_0/java_intro/ class=md-tabs__link> Learn </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=FRCCode.org class="md-nav__button md-logo" aria-label=FRCCode.org data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> FRCCode.org </label> <div class=md-nav__source> <a href=https://github.com/frccode/frccode title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> frccode/frccode </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> FRCCode </span> </a> </li> <li class=md-nav__item> <a href=../../../support_and_help/ class=md-nav__link> <span class=md-ellipsis> Support &amp; Help </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Learn </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Learn </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex> <span class=md-ellipsis> Chapter 0 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Chapter 0 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_0/java_intro/ class=md-nav__link> <span class=md-ellipsis> Introduction to Java in FRC Programming </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex> <span class=md-ellipsis> Chapter 1 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Chapter 1 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_1/1_prerequisites_intro/ class=md-nav__link> <span class=md-ellipsis> Prerequisites of FRC Programming </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_1/2_wpilib/ class=md-nav__link> <span class=md-ellipsis> WPIlib and Associated Tools </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_1/4_Version_Control_intro/ class=md-nav__link> <span class=md-ellipsis> Version Control Guide for FRC Teams </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex> <span class=md-ellipsis> Chapter 2 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Chapter 2 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_2/simple_robot_programming/ class=md-nav__link> <span class=md-ellipsis> An Intro Through Timed Robot </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex> <span class=md-ellipsis> Chapter 3 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Chapter 3 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_3/1_command_based_programming/ class=md-nav__link> <span class=md-ellipsis> Command-Based Robot Programming Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex> <span class=md-ellipsis> Chapter 4 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Chapter 4 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_4/PID/ class=md-nav__link> <span class=md-ellipsis> PID Control </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_4/simple_profiling/ class=md-nav__link> <span class=md-ellipsis> Motion Profiling: Getting Started </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6 checked> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex> <span class=md-ellipsis> Chapter 5 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=true> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Chapter 5 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../differential_control/ class=md-nav__link> <span class=md-ellipsis> Differential (Tank) Drive Programming Guide </span> </a> </li> <li class=md-nav__item> <a href=../drive_bases/ class=md-nav__link> <span class=md-ellipsis> Drive Base in FRC Programming </span> </a> </li> <li class=md-nav__item> <a href=../simple_trajectories/ class=md-nav__link> <span class=md-ellipsis> Swerve Trajectory: Getting Started </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Swerve Drive Programming Guide </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Swerve Drive Programming Guide </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#1-introduction class=md-nav__link> <span class=md-ellipsis> 1. Introduction </span> </a> </li> <li class=md-nav__item> <a href=#2-core-concepts class=md-nav__link> <span class=md-ellipsis> 2. Core Concepts </span> </a> <nav class=md-nav aria-label="2. Core Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#control-definitions class=md-nav__link> <span class=md-ellipsis> Control Definitions </span> </a> </li> <li class=md-nav__item> <a href=#swerve-module-components class=md-nav__link> <span class=md-ellipsis> Swerve Module Components </span> </a> </li> <li class=md-nav__item> <a href=#key-classes-in-wpilib class=md-nav__link> <span class=md-ellipsis> Key Classes in WPILIB </span> </a> <nav class=md-nav aria-label="Key Classes in WPILIB"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#chassisspeeds class=md-nav__link> <span class=md-ellipsis> ChassisSpeeds </span> </a> </li> <li class=md-nav__item> <a href=#swervemodulestate class=md-nav__link> <span class=md-ellipsis> SwerveModuleState </span> </a> </li> <li class=md-nav__item> <a href=#swervemodulestate_1 class=md-nav__link> <span class=md-ellipsis> SwerveModuleState </span> </a> </li> <li class=md-nav__item> <a href=#swervedrivekinematics-object class=md-nav__link> <span class=md-ellipsis> SwerveDriveKinematics Object </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#joystick-input-to-motor-command class=md-nav__link> <span class=md-ellipsis> Joystick Input to Motor Command </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-mathematical-foundation class=md-nav__link> <span class=md-ellipsis> 3. Mathematical Foundation </span> </a> <nav class=md-nav aria-label="3. Mathematical Foundation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#coordinate-transformation class=md-nav__link> <span class=md-ellipsis> Coordinate Transformation </span> </a> </li> <li class=md-nav__item> <a href=#inverse-kinematics class=md-nav__link> <span class=md-ellipsis> Inverse Kinematics </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-additional-control-concepts class=md-nav__link> <span class=md-ellipsis> 4. Additional Control Concepts </span> </a> <nav class=md-nav aria-label="4. Additional Control Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#speed-desaturation class=md-nav__link> <span class=md-ellipsis> Speed Desaturation </span> </a> </li> <li class=md-nav__item> <a href=#wheel-optimization class=md-nav__link> <span class=md-ellipsis> Wheel Optimization </span> </a> </li> <li class=md-nav__item> <a href=#motor-control class=md-nav__link> <span class=md-ellipsis> Motor Control </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-coordinate-systems class=md-nav__link> <span class=md-ellipsis> 5. Coordinate Systems </span> </a> <nav class=md-nav aria-label="5. Coordinate Systems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#wpilib-coordinate-system-nwu class=md-nav__link> <span class=md-ellipsis> WPILIB Coordinate System (NWU) </span> </a> </li> <li class=md-nav__item> <a href=#alliance-considerations class=md-nav__link> <span class=md-ellipsis> Alliance Considerations </span> </a> </li> <li class=md-nav__item> <a href=#key-swerve-coordinate-system-adjustments-to-keep-track-of class=md-nav__link> <span class=md-ellipsis> Key Swerve Coordinate System Adjustments to keep track of </span> </a> <nav class=md-nav aria-label="Key Swerve Coordinate System Adjustments to keep track of"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kinematics-considerations class=md-nav__link> <span class=md-ellipsis> Kinematics Considerations </span> </a> </li> <li class=md-nav__item> <a href=#steering-inversion-considerations class=md-nav__link> <span class=md-ellipsis> Steering Inversion Considerations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6-implementation-guide class=md-nav__link> <span class=md-ellipsis> 6. Implementation Guide </span> </a> <nav class=md-nav aria-label="6. Implementation Guide"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#drive-constants-setup class=md-nav__link> <span class=md-ellipsis> Drive Constants Setup </span> </a> </li> <li class=md-nav__item> <a href=#complete-swerve-module-class class=md-nav__link> <span class=md-ellipsis> Complete Swerve Module Class </span> </a> </li> <li class=md-nav__item> <a href=#basic-swerve-drive-subsystem-structure class=md-nav__link> <span class=md-ellipsis> Basic Swerve Drive Subsystem Structure </span> </a> </li> <li class=md-nav__item> <a href=#teleop-command-implementation class=md-nav__link> <span class=md-ellipsis> Teleop Command Implementation </span> </a> </li> <li class=md-nav__item> <a href=#integrating-swerve-drive-in-robotcontainer class=md-nav__link> <span class=md-ellipsis> Integrating Swerve Drive in RobotContainer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-troubleshooting class=md-nav__link> <span class=md-ellipsis> 7. Troubleshooting </span> </a> <nav class=md-nav aria-label="7. Troubleshooting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-issues-and-possible-fixes class=md-nav__link> <span class=md-ellipsis> Common Issues and Possible fixes </span> </a> </li> <li class=md-nav__item> <a href=#debug-tools class=md-nav__link> <span class=md-ellipsis> Debug Tools </span> </a> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#9-reference-resources class=md-nav__link> <span class=md-ellipsis> 9. Reference Resources </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex> <span class=md-ellipsis> Chapter 6 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Chapter 6 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_6/auto_strategy/ class=md-nav__link> <span class=md-ellipsis> FRC Autonomous Programming - Strategy and Planning </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_6/extrainfoPuttingelsewhere/ class=md-nav__link> <span class=md-ellipsis> extrainfoPuttingelsewhere </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_6/writing_autos/ class=md-nav__link> <span class=md-ellipsis> FRC Autonomous Programming - Technical Implementation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8 id=__nav_3_8_label tabindex> <span class=md-ellipsis> Chapter 7 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_8_label aria-expanded=false> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Chapter 7 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_7/logging_intro/ class=md-nav__link> <span class=md-ellipsis> Logging intro </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9 id=__nav_3_9_label tabindex> <span class=md-ellipsis> Chapter 8 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_9_label aria-expanded=false> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Chapter 8 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Chapter_8/apriltag_processing/ class=md-nav__link> <span class=md-ellipsis> AprilTag Processing: Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_8/pose_estimators_and_kalman_filters/ class=md-nav__link> <span class=md-ellipsis> Kalman Filters &amp; Pose Estimation: Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../Chapter_8/vision_explanation/ class=md-nav__link> <span class=md-ellipsis> Vision Processing: Getting Started </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#1-introduction class=md-nav__link> <span class=md-ellipsis> 1. Introduction </span> </a> </li> <li class=md-nav__item> <a href=#2-core-concepts class=md-nav__link> <span class=md-ellipsis> 2. Core Concepts </span> </a> <nav class=md-nav aria-label="2. Core Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#control-definitions class=md-nav__link> <span class=md-ellipsis> Control Definitions </span> </a> </li> <li class=md-nav__item> <a href=#swerve-module-components class=md-nav__link> <span class=md-ellipsis> Swerve Module Components </span> </a> </li> <li class=md-nav__item> <a href=#key-classes-in-wpilib class=md-nav__link> <span class=md-ellipsis> Key Classes in WPILIB </span> </a> <nav class=md-nav aria-label="Key Classes in WPILIB"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#chassisspeeds class=md-nav__link> <span class=md-ellipsis> ChassisSpeeds </span> </a> </li> <li class=md-nav__item> <a href=#swervemodulestate class=md-nav__link> <span class=md-ellipsis> SwerveModuleState </span> </a> </li> <li class=md-nav__item> <a href=#swervemodulestate_1 class=md-nav__link> <span class=md-ellipsis> SwerveModuleState </span> </a> </li> <li class=md-nav__item> <a href=#swervedrivekinematics-object class=md-nav__link> <span class=md-ellipsis> SwerveDriveKinematics Object </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#joystick-input-to-motor-command class=md-nav__link> <span class=md-ellipsis> Joystick Input to Motor Command </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-mathematical-foundation class=md-nav__link> <span class=md-ellipsis> 3. Mathematical Foundation </span> </a> <nav class=md-nav aria-label="3. Mathematical Foundation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#coordinate-transformation class=md-nav__link> <span class=md-ellipsis> Coordinate Transformation </span> </a> </li> <li class=md-nav__item> <a href=#inverse-kinematics class=md-nav__link> <span class=md-ellipsis> Inverse Kinematics </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-additional-control-concepts class=md-nav__link> <span class=md-ellipsis> 4. Additional Control Concepts </span> </a> <nav class=md-nav aria-label="4. Additional Control Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#speed-desaturation class=md-nav__link> <span class=md-ellipsis> Speed Desaturation </span> </a> </li> <li class=md-nav__item> <a href=#wheel-optimization class=md-nav__link> <span class=md-ellipsis> Wheel Optimization </span> </a> </li> <li class=md-nav__item> <a href=#motor-control class=md-nav__link> <span class=md-ellipsis> Motor Control </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-coordinate-systems class=md-nav__link> <span class=md-ellipsis> 5. Coordinate Systems </span> </a> <nav class=md-nav aria-label="5. Coordinate Systems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#wpilib-coordinate-system-nwu class=md-nav__link> <span class=md-ellipsis> WPILIB Coordinate System (NWU) </span> </a> </li> <li class=md-nav__item> <a href=#alliance-considerations class=md-nav__link> <span class=md-ellipsis> Alliance Considerations </span> </a> </li> <li class=md-nav__item> <a href=#key-swerve-coordinate-system-adjustments-to-keep-track-of class=md-nav__link> <span class=md-ellipsis> Key Swerve Coordinate System Adjustments to keep track of </span> </a> <nav class=md-nav aria-label="Key Swerve Coordinate System Adjustments to keep track of"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kinematics-considerations class=md-nav__link> <span class=md-ellipsis> Kinematics Considerations </span> </a> </li> <li class=md-nav__item> <a href=#steering-inversion-considerations class=md-nav__link> <span class=md-ellipsis> Steering Inversion Considerations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6-implementation-guide class=md-nav__link> <span class=md-ellipsis> 6. Implementation Guide </span> </a> <nav class=md-nav aria-label="6. Implementation Guide"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#drive-constants-setup class=md-nav__link> <span class=md-ellipsis> Drive Constants Setup </span> </a> </li> <li class=md-nav__item> <a href=#complete-swerve-module-class class=md-nav__link> <span class=md-ellipsis> Complete Swerve Module Class </span> </a> </li> <li class=md-nav__item> <a href=#basic-swerve-drive-subsystem-structure class=md-nav__link> <span class=md-ellipsis> Basic Swerve Drive Subsystem Structure </span> </a> </li> <li class=md-nav__item> <a href=#teleop-command-implementation class=md-nav__link> <span class=md-ellipsis> Teleop Command Implementation </span> </a> </li> <li class=md-nav__item> <a href=#integrating-swerve-drive-in-robotcontainer class=md-nav__link> <span class=md-ellipsis> Integrating Swerve Drive in RobotContainer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-troubleshooting class=md-nav__link> <span class=md-ellipsis> 7. Troubleshooting </span> </a> <nav class=md-nav aria-label="7. Troubleshooting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-issues-and-possible-fixes class=md-nav__link> <span class=md-ellipsis> Common Issues and Possible fixes </span> </a> </li> <li class=md-nav__item> <a href=#debug-tools class=md-nav__link> <span class=md-ellipsis> Debug Tools </span> </a> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#9-reference-resources class=md-nav__link> <span class=md-ellipsis> 9. Reference Resources </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=swerve-drive-programming-guide>Swerve Drive Programming Guide<a class=headerlink href=#swerve-drive-programming-guide title="Permanent link">&para;</a></h1> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">&para;</a></h2> <ol> <li><a href=#introduction>Introduction</a></li> <li><a href=#core-concepts>Core Concepts</a></li> <li><a href=#mathematical-foundation>Mathematical Foundation</a></li> <li><a href=#additional-control-concepts>Additional Control Concepts</a></li> <li><a href=#coordinate-systems>Coordinate Systems</a></li> <li><a href=#implementation-guide>Implementation Guide</a></li> <li><a href=#troubleshooting>Troubleshooting</a></li> <li><a href=#additional-resources>Additional Resources</a></li> </ol> <h2 id=1-introduction>1. Introduction<a class=headerlink href=#1-introduction title="Permanent link">&para;</a></h2> <p>This guide covers the programming concepts needed to implement a swerve drive system using the WPILIB framework. Understanding how the your joystick inputs are turned into module commands will greatly help in debugging common programming issues associated with swerve.</p> <blockquote> <p><strong>Note:</strong> While there are many Swerve Drive solutions that abstract much of the coding you need to do to create working swerve software such as (YAGSL, CTRE), it is recommended to learn the WPILIB way of creating swerve software. This will enable you to have more control over every part of your swerve code from joystick to motor.</p> <p><strong>Note:</strong> Before starting this section, review the <a href=./command_based_programming.md>Command-Based Programming Guide</a>. Many concepts here rely on command-based programming principles discussed in that guide.</p> </blockquote> <p>For a quick start, you can skip to the <a href=#implementation-guide>Implementation Guide</a> to begin coding your swerve drive. However it's recommended to review sections 2–5 first for a deeper understanding.</p> <p><strong>What You'll Learn:</strong> - Fundamental swerve drive concepts - Mathematical principles behind swerve kinematics - WPILIB implementation details - Best practices for control systems - Common pitfalls and solutions</p> <h2 id=2-core-concepts>2. Core Concepts<a class=headerlink href=#2-core-concepts title="Permanent link">&para;</a></h2> <p>Below are some common terms associated with swerve drive:</p> <h3 id=control-definitions>Control Definitions<a class=headerlink href=#control-definitions title="Permanent link">&para;</a></h3> <ul> <li> <p><strong>Holonomic Drive Defininition (Swerve)</strong></p> <ul> <li>Holonomic drive systems allow robots to move in any direction without being in a specific orientation, combining forward, lateral, and rotational motion simultaneously. </li> <li>Each wheel can rotate and steer independently</li> <li><a href="https://conceptual-innovations.com/exploring-holonomic-drives-systems-with-a-deep-dive-into-halodrive/#:~:text=Holonomic%20drive%20systems%20enable%20a,lateral%20and%20rotational%20motion%20simultaneously.">Reference</a></li> </ul> </li> <li> <p><strong>Trajectory Control</strong></p> <ul> <li>Pre-planned or dynamically generated paths</li> <li>Automated movement along specific routes</li> <li>Used for autonomous navigation</li> </ul> </li> <li> <p><strong>Teleop Control</strong></p> <ul> <li>Direct driver control via joysticks</li> <li>Real-time response to input</li> <li>Used during driver-controlled periods</li> </ul> </li> </ul> <h3 id=swerve-module-components>Swerve Module Components<a class=headerlink href=#swerve-module-components title="Permanent link">&para;</a></h3> <ul> <li> <p>Each swerve module consists of:</p> <ul> <li><strong>Drive Motor</strong>: Controls wheel speed</li> <li><strong>Steer Motor</strong>: Controls wheel direction</li> <li><strong>Encoder</strong>: Provides position feedback</li> <li><strong>Wheel</strong>: The contact point with the ground</li> </ul> </li> <li> <p>The drive motor, steer motor, and encoder are usually team specific and require their own unique instantiation. </p> <ul> <li><strong>Drive Motor</strong></li> <li><strong>Steer Motor</strong></li> <li><strong>Absolute Encoder</strong></li> </ul> </li> </ul> <h3 id=key-classes-in-wpilib>Key Classes in WPILIB<a class=headerlink href=#key-classes-in-wpilib title="Permanent link">&para;</a></h3> <h4 id=chassisspeeds><strong>ChassisSpeeds</strong><a class=headerlink href=#chassisspeeds title="Permanent link">&para;</a></h4> <p>The <code>ChassisSpeeds</code> class in relation to the swerve drive represents the desired movement of the robot as a whole. It encapsulates three components: - <strong>xVelocity</strong>: Forward/backward speed (meters per second) - <strong>yVelocity</strong>: Left/right speed (meters per second) - <strong>omegaVelocity</strong>: Rotational speed (radians per second)</p> <p>This class is commonly used as an input to swerve drive kinematics, which then calculates the necessary wheel speeds and angles for each module to achieve the desired chassis motion. By adjusting these values, you can command the robot to move in any direction and rotate simultaneously.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1>// Stores target velocities for the entire robot</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>ChassisSpeeds</span><span class=w> </span><span class=n>chassisSpeeds</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ChassisSpeeds</span><span class=p>(</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class=n>xVelocity</span><span class=p>,</span><span class=w>    </span><span class=c1>// Forward/backward speed (m/s)</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span><span class=n>yVelocity</span><span class=p>,</span><span class=w>    </span><span class=c1>// Left/right speed (m/s)</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=n>omegaVelocity</span><span class=w> </span><span class=c1>// Rotational speed (rad/s)</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=p>);</span>
</code></pre></div> <h4 id=swervemodulestate><strong>SwerveModuleState</strong><a class=headerlink href=#swervemodulestate title="Permanent link">&para;</a></h4> <p>Represents the state of an individual swerve drive module, encapsulating both its current angle (direction) and speed (velocity). By doing so, it enables coordinated control of all modules to achieve complex robot maneuvers such as strafing, rotating, and omnidirectional movement.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1>// Stores angle and speed for individual modules</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>SwerveModuleState</span><span class=w> </span><span class=n>moduleState</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SwerveModuleState</span><span class=p>(</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>    </span><span class=n>speed</span><span class=p>,</span><span class=w>  </span><span class=c1>// Speed in m/s</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>    </span><span class=n>angle</span><span class=w>   </span><span class=c1>// Angle as Rotation2d</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=p>);</span>
</code></pre></div> <h4 id=swervemodulestate_1><strong>SwerveModuleState</strong><a class=headerlink href=#swervemodulestate_1 title="Permanent link">&para;</a></h4> <p>Represents the state of an individual swerve drive module, encapsulating both its current angle (direction) and speed (velocity). By doing so, it enables coordinated control of all modules to achieve complex robot maneuvers such as strafing, rotating, and omnidirectional movement.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1>// Stores angle and speed for individual modules</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>SwerveModuleState</span><span class=w> </span><span class=n>moduleState</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SwerveModuleState</span><span class=p>(</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>    </span><span class=n>speed</span><span class=p>,</span><span class=w>  </span><span class=c1>// Speed in m/s</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>    </span><span class=n>angle</span><span class=w>   </span><span class=c1>// Angle as Rotation2d</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=p>);</span>
</code></pre></div> <h4 id=swervedrivekinematics-object><strong>SwerveDriveKinematics Object</strong><a class=headerlink href=#swervedrivekinematics-object title="Permanent link">&para;</a></h4> <p>The <code>SwerveDriveKinematics</code> class in WPILIB is responsible for converting desired robot motion (chassis speeds) into individual swerve module states (speed and angle for each wheel). It uses the physical positions of each module relative to the robot center to perform these calculations.</p> <ul> <li><strong>How to create a kinematics object:</strong> You must specify the position of each swerve module as a <code>Translation2d</code> from the robot's center in meters.</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1>// Example: Four-module swerve drive</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=n>SwerveDriveKinematics</span><span class=w> </span><span class=n>kinematics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SwerveDriveKinematics</span><span class=p>(</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>    </span><span class=k>new</span><span class=w> </span><span class=n>Translation2d</span><span class=p>(</span><span class=mf>0.3</span><span class=p>,</span><span class=w> </span><span class=mf>0.3</span><span class=p>),</span><span class=w>   </span><span class=c1>// Front Left</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class=k>new</span><span class=w> </span><span class=n>Translation2d</span><span class=p>(</span><span class=mf>0.3</span><span class=p>,</span><span class=w> </span><span class=o>-</span><span class=mf>0.3</span><span class=p>),</span><span class=w>  </span><span class=c1>// Front Right</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>    </span><span class=k>new</span><span class=w> </span><span class=n>Translation2d</span><span class=p>(</span><span class=o>-</span><span class=mf>0.3</span><span class=p>,</span><span class=w> </span><span class=mf>0.3</span><span class=p>),</span><span class=w>  </span><span class=c1>// Back Left</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=k>new</span><span class=w> </span><span class=n>Translation2d</span><span class=p>(</span><span class=o>-</span><span class=mf>0.3</span><span class=p>,</span><span class=w> </span><span class=o>-</span><span class=mf>0.3</span><span class=p>)</span><span class=w>  </span><span class=c1>// Back Right</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=p>);</span>
</code></pre></div> <ul> <li>Below is a simple example of converting desired robot motion into individual swerve module states using the <code>SwerveDriveKinematics</code> object:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1>// Desired robot motion (forward, sideways, rotation)</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>ChassisSpeeds</span><span class=w> </span><span class=n>speeds</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ChassisSpeeds</span><span class=p>(</span><span class=mf>2.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>1.0</span><span class=p>);</span><span class=w> </span><span class=c1>// 2 m/s forward, no strafe, 1 rad/s rotation</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=c1>// Convert to module states</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=n>SwerveModuleState</span><span class=o>[]</span><span class=w> </span><span class=n>states</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Constants</span><span class=p>.</span><span class=na>kinematics</span><span class=p>.</span><span class=na>toSwerveModuleStates</span><span class=p>(</span><span class=n>speeds</span><span class=p>);</span>
</code></pre></div> <h3 id=joystick-input-to-motor-command>Joystick Input to Motor Command<a class=headerlink href=#joystick-input-to-motor-command title="Permanent link">&para;</a></h3> <p>Joystick inputs flow down to the motors on the drivetrain using a sequence shown below. The inputs go through two "code layers" before ending up as a motor command.</p> <p><strong>Command Layer Flowchart</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>    A[Joystick Inputs] --&gt; B[TeleopSwerveCommand.execute()]
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    B --&gt; C[Apply Red alliance flipping if applicable, scaling, deadbands]
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    C --&gt; D[ChassisSpeeds.fromFieldRelativeSpeeds()]
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    D --&gt; E[SwerveDrive.drive()]
</code></pre></div> <p><strong>Drive Subsystem Flowchart</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>    F[SwerveDrive.drive(chassisSpeeds)] --&gt; 
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>    F --&gt; G[SwerveDriveKinematics.toSwerveModuleStates()]
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    G --&gt; H[SwerveDriveKinematics.desaturateWheelSpeeds()]
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    H --&gt; I[SwerveModule.setDesiredState()]
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>    I --&gt; J[SwerveModule: steerPID.calculate() &amp; driveFeedforward.calculate() &amp; drivePID.calculate()]
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>    J --&gt; K[driveMotor.set() &amp; steerMotor.set()]
</code></pre></div> <h2 id=3-mathematical-foundation>3. Mathematical Foundation<a class=headerlink href=#3-mathematical-foundation title="Permanent link">&para;</a></h2> <p><img alt="Swerve Drive Coordinate Diagram" src=../swerve_coordinate.jpg></p> <h3 id=coordinate-transformation>Coordinate Transformation<a class=headerlink href=#coordinate-transformation title="Permanent link">&para;</a></h3> <p>Coordinate transformation enables your FRC robot to interpret movement commands relative to the field, regardless of its current orientation. For example, during teleop, if the driver pushes the joystick forward, the robot should always move toward the opponent’s alliance wall, even if the robot is rotated or facing sideways. </p> <p>This is achieved by converting field-relative commands (from the driver’s perspective) into robot-relative wheel motions using trigonometric functions. The robot uses its gyro heading and the desired field-relative velocities to calculate the correct wheel speeds and angles, ensuring consistent and intuitive control for the driver throughout the match.</p> <p><strong>Field-Oriented Control:</strong> Convert field coordinates to robot coordinates: <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>x&#39; = x*cos(θ) + y*sin(θ)
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>y&#39; = y*cos(θ) - x*sin(θ)
</code></pre></div></p> <p>Where: - <code>(x, y)</code> = Field-relative coordinates - <code>(x', y')</code> = Robot-relative coordinates<br> - <code>θ</code> = Robot orientation</p> <h3 id=inverse-kinematics>Inverse Kinematics<a class=headerlink href=#inverse-kinematics title="Permanent link">&para;</a></h3> <p>Swerve drive uses inverse kinematics to calculate individual module states from desired robot motion as shown below:</p> <p><img alt="Swerve Drive Vector Addition Diagram" src=../SwerveVector.png></p> <p><strong>Simple Explanation</strong></p> <p>Imagine you have two arrows: one for how you want the robot to move (forward, sideways, or diagonally), and one for how much you want it to spin. You point each arrow with your joysticks. The longer the arrow, the stronger that movement or spin. The robot adds these arrows together to figure out which way and how fast each wheel should go. If you push the spin joystick more, the robot will turn more; if you push the move joystick more, it will drive more in that direction as reflected by the vectors.</p> <p><strong>Vector Addition Principle:</strong> Each swerve module takes advantage of simple vector addition. For each module, the final velocity vector is the sum of: 1. <strong>Translation vector</strong> (desired robot velocity) 2. <strong>Rotation vector</strong> (tangent to rotation at module position) 3. <strong>Final vector</strong> (Summation of two vectors)</p> <p><strong>Formula:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>V_module = V_translation + ω × r_module
</code></pre></div></p> <p>Variable defining: - <code>V_module</code> = Final module velocity vector - <code>V_translation</code> = Desired translation velocity - <code>ω</code> = Angular velocity - <code>r_module</code> = Position vector from robot center to module</p> <h2 id=4-additional-control-concepts>4. Additional Control Concepts<a class=headerlink href=#4-additional-control-concepts title="Permanent link">&para;</a></h2> <p>Below are some additional concepts that will help optimize your swerve drive so the modules are operating in a fashion that is kinematically feasible and taking the shortest mechanical movements to reach it's goal.</p> <h3 id=speed-desaturation>Speed Desaturation<a class=headerlink href=#speed-desaturation title="Permanent link">&para;</a></h3> <p>Speed desaturation ensures that no swerve module is commanded to exceed its physical maximum speed. When combined translation and rotation commands result in wheel speeds above this limit, all module speeds are scaled down proportionally. This maintains the intended motion direction while keeping commands achievable for the hardware.</p> <p><strong>How it works:</strong><br> When calculated module speeds exceed maximum velocity, all modules must be scaled proportionally. Below is the code that scales down all module speeds proportionally:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>desaturateWheelSpeeds</span><span class=p>(</span><span class=n>SwerveModuleState</span><span class=o>[]</span><span class=w> </span><span class=n>moduleStates</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>attainableMaxSpeedMetersPerSecond</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>recordedSpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>SwerveModuleState</span><span class=w> </span><span class=n>moduleState</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>moduleStates</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>        </span><span class=n>recordedSpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>max</span><span class=p>(</span><span class=n>recordedSpeed</span><span class=p>,</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>abs</span><span class=p>(</span><span class=n>moduleState</span><span class=p>.</span><span class=na>speedMetersPerSecond</span><span class=p>));</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>recordedSpeed</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>attainableMaxSpeedMetersPerSecond</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>SwerveModuleState</span><span class=w> </span><span class=n>moduleState</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>moduleStates</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>            </span><span class=n>moduleState</span><span class=p>.</span><span class=na>speedMetersPerSecond</span><span class=w> </span><span class=o>=</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>                </span><span class=n>moduleState</span><span class=p>.</span><span class=na>speedMetersPerSecond</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>recordedSpeed</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>attainableMaxSpeedMetersPerSecond</span><span class=p>;</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=p>}</span>
</code></pre></div> <h3 id=wheel-optimization>Wheel Optimization<a class=headerlink href=#wheel-optimization title="Permanent link">&para;</a></h3> <p>Wheel optimization minimizes the amount each module needs to rotate to reach its target angle. By choosing the shortest path, the module can reverse its wheel direction instead of rotating a full 180°, resulting in faster and more efficient movement.</p> <p><strong>How it works:</strong><br> If the angle difference between the current and target position is greater than 90°, the module reverses its speed and adds 180° to the target angle. This reduces unnecessary rotation.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1>// Calculate angle difference</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=kt>double</span><span class=w> </span><span class=n>angleDifference</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>targetAngle</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>currentAngle</span><span class=p>;</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=c1>// Normalize to [-180, 180] degrees</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>angleDifference</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>180</span><span class=p>)</span><span class=w> </span><span class=n>angleDifference</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=mi>360</span><span class=p>;</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>angleDifference</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=o>-</span><span class=mi>180</span><span class=p>)</span><span class=w> </span><span class=n>angleDifference</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>360</span><span class=p>;</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=c1>// If &gt; 90 degrees, flip direction and reverse speed</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>Math</span><span class=p>.</span><span class=na>abs</span><span class=p>(</span><span class=n>angleDifference</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>90</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>    </span><span class=n>targetAngle</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>180</span><span class=p>;</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>    </span><span class=n>speed</span><span class=w> </span><span class=o>*=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=p>;</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=w>    </span><span class=n>angleDifference</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=p>(</span><span class=n>angleDifference</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=o>-</span><span class=mi>180</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>180</span><span class=p>;</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=p>}</span>
</code></pre></div> <h3 id=motor-control>Motor Control<a class=headerlink href=#motor-control title="Permanent link">&para;</a></h3> <p>Motor control ensures each swerve module accurately reaches its desired speed and angle using feedback and feedforward algorithms.</p> <p><strong>Steering Control:</strong><br> PID control is used to precisely position the steering motor to the target angle, correcting for any error between the current and desired position.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=kt>double</span><span class=w> </span><span class=n>output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>steerPID</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span><span class=n>currentAngle</span><span class=p>,</span><span class=w> </span><span class=n>targetAngle</span><span class=p>);</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=n>steerMotor</span><span class=p>.</span><span class=na>setVoltage</span><span class=p>(</span><span class=n>output</span><span class=p>);</span>
</code></pre></div> <p><strong>Drive Control:</strong><br> Combines feedforward (predictive) and feedback (corrective) control to achieve the desired wheel velocity. Feedforward estimates the required output, while PID corrects for any deviation.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kt>double</span><span class=w> </span><span class=n>feedforward</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>driveFeedforward</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span><span class=n>targetVelocity</span><span class=p>);</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=kt>double</span><span class=w> </span><span class=n>feedback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>drivePID</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span><span class=n>currentVelocity</span><span class=p>,</span><span class=w> </span><span class=n>targetVelocity</span><span class=p>);</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=n>driveMotor</span><span class=p>.</span><span class=na>setVoltage</span><span class=p>(</span><span class=n>feedforward</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>feedback</span><span class=p>);</span>
</code></pre></div> <p><strong>Drive Control:</strong><br> Combines feedforward (predictive) and feedback (corrective) control to achieve the desired wheel velocity. Feedforward estimates the required output, while PID corrects for any deviation.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kt>double</span><span class=w> </span><span class=n>feedforward</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>driveFeedforward</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span><span class=n>targetVelocity</span><span class=p>);</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=kt>double</span><span class=w> </span><span class=n>feedback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>drivePID</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span><span class=n>currentVelocity</span><span class=p>,</span><span class=w> </span><span class=n>targetVelocity</span><span class=p>);</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=n>driveMotor</span><span class=p>.</span><span class=na>setVoltage</span><span class=p>(</span><span class=n>feedforward</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>feedback</span><span class=p>);</span>
</code></pre></div> <p>Please reference <a href=./Chapter_4/simple_profiling.md>Simple Profiling for Swerve Drive</a> for an in depth explanation on how to tune a velocity control system.</p> <h2 id=5-coordinate-systems>5. Coordinate Systems<a class=headerlink href=#5-coordinate-systems title="Permanent link">&para;</a></h2> <p><img alt="WPILIB Swerve Coordinate System" src=../SwerveCoord1.png></p> <p>Understanding and adhering to the WPILIB coordinate system is crucial because it ensures consistent movement commands, sensor readings, and autonomous routines across the swerve drive. Teams have frequently run into switching alliance issues/direction confusion/unreliable feild control etc. due to misunderstanding the WPILIB coordinate system.</p> <h3 id=wpilib-coordinate-system-nwu>WPILIB Coordinate System (NWU)<a class=headerlink href=#wpilib-coordinate-system-nwu title="Permanent link">&para;</a></h3> <p><strong>Field Coordinates:</strong> - <strong>X-axis</strong>: Points toward opponent alliance (positive = forward) - <strong>Y-axis</strong>: Points to the left when facing forward<br> - <strong>Z-axis</strong>: Points up - <strong>Rotation</strong>: Counterclockwise positive, starting from +X axis</p> <p><strong>Important Notes:</strong> - All components must use the same coordinate system - Angles typically range from -180° to +180° - Field-oriented driving maintains consistent directions regardless of robot orientation - All units are in <strong>Meters</strong></p> <h3 id=alliance-considerations>Alliance Considerations<a class=headerlink href=#alliance-considerations title="Permanent link">&para;</a></h3> <p><strong>Everything is in a Blue Alliance Perspective:</strong> 🔵 - Coordinate system origin at blue alliance corner - Positive X = toward red alliance - Positive Y = toward left side of field</p> <h3 id=key-swerve-coordinate-system-adjustments-to-keep-track-of>Key Swerve Coordinate System Adjustments to keep track of<a class=headerlink href=#key-swerve-coordinate-system-adjustments-to-keep-track-of title="Permanent link">&para;</a></h3> <p><strong>Red Alliance Considerations:</strong> </p> <p>Actions(Driver inputs, autonomous paths) taken on the Red Alliance side must be mirrored </p> <ul> <li><strong>Note:</strong> Do not mirror omega turns: Omega turns are specialized maneuvers and should not be mirrored, as this may lead to unintended behavior or incorrect movement patterns.</li> </ul> <p>Below is an example of an action that must be mirrored. <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1>// Flip coordinates for red alliance in mirrored fields</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>DriverStation</span><span class=p>.</span><span class=na>getAlliance</span><span class=p>().</span><span class=na>get</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>DriverStation</span><span class=p>.</span><span class=na>Alliance</span><span class=p>.</span><span class=na>Red</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>    </span><span class=n>xVelocity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>xVelocity</span><span class=p>;</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>    </span><span class=n>yVelocity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>yVelocity</span><span class=p>;</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=p>}</span>
</code></pre></div></p> <h4 id=kinematics-considerations><strong>Kinematics Considerations</strong><a class=headerlink href=#kinematics-considerations title="Permanent link">&para;</a></h4> <p>When setting up your Kinematics object as shown below, please be aware that it is very easy to mess up assigning kinematics to swerve modules. Please ensure the order your modules are in and the location of the modules for your kinematics match the coordinate system pictured here.</p> <p>Teams often do a <strong>Front Left, Front Right, Back Left, Back Right</strong> setup. </p> <p><img alt="Swerve Drive Kinematics Diagram" src=../kinematics.svg></p> <h4 id=steering-inversion-considerations><strong>Steering Inversion Considerations</strong><a class=headerlink href=#steering-inversion-considerations title="Permanent link">&para;</a></h4> <p>Depending on your mechanical setup and wiring, the direction that increases the encoder value may not match the direction that increases the motor output. If the module turns in the opposite direction of the command, you may need to add a negative sign to the output (e.g., <code>steerMotor.setVoltage(-output)</code>). This ensures the feedback loop drives the module toward the correct angle. Always verify module movement matches software commands and adjust sign as needed for your robot.</p> <h2 id=6-implementation-guide>6. Implementation Guide<a class=headerlink href=#6-implementation-guide title="Permanent link">&para;</a></h2> <p>Now that you've covered what's under the hood when it comes to swerve drive. Here's a step by step implmentation guide.</p> <p>We will use the CTRE implementation of motors/sensors due to its commonality. However, this setup works the same with different vendored motors/sensors. We will cover setup with different motors/sensors more in <a href=#complete-swerve-module-class>Complete Swerve Module Class</a>.</p> <h3 id=drive-constants-setup>Drive Constants Setup<a class=headerlink href=#drive-constants-setup title="Permanent link">&para;</a></h3> <p>To keep your swerve code organized and maintainable, it's best practice to centralize all drive-related constants and commonly reused objects in a dedicated file. This approach reduces the chances of duplicatate objects and makes your swerve code easier to navigate.</p> <p>Follow these steps:</p> <ol> <li>Copy the following kinematics setup into a seperate class labeled "DriveConstants."</li> <li>Adjust the "WHEELBASE", "TRACKWIDTH" parameters as according to your swerve drive in "meters."</li> <li>Define the swerve module order (Please reference <a href=#Kinematics-Considerations>Kinematics Considerations</a>).</li> </ol> <p>Kinematics explaination: <a href=#swervedrivekinematics-object>SwerveDriveKinematics Object</a>. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DriveConstants</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=w>    </span><span class=c1>// Robot dimensions (meters)</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>WHEELBASE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.6</span><span class=p>;</span><span class=w>  </span><span class=c1>// Distance between front/back wheels</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>TRACKWIDTH</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.6</span><span class=p>;</span><span class=w> </span><span class=c1>// Distance between left/right wheels</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>    </span><span class=c1>// Module positions relative to robot center</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Translation2d</span><span class=w> </span><span class=n>FRONT_LEFT_LOCATION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Translation2d</span><span class=p>(</span><span class=n>WHEELBASE</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=n>TRACKWIDTH</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Translation2d</span><span class=w> </span><span class=n>FRONT_RIGHT_LOCATION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Translation2d</span><span class=p>(</span><span class=n>WHEELBASE</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=o>-</span><span class=n>TRACKWIDTH</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Translation2d</span><span class=w> </span><span class=n>BACK_LEFT_LOCATION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Translation2d</span><span class=p>(</span><span class=o>-</span><span class=n>WHEELBASE</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=n>TRACKWIDTH</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Translation2d</span><span class=w> </span><span class=n>BACK_RIGHT_LOCATION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Translation2d</span><span class=p>(</span><span class=o>-</span><span class=n>WHEELBASE</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=o>-</span><span class=n>TRACKWIDTH</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>SwerveDriveKinematics</span><span class=w> </span><span class=n>KINEMATICS</span><span class=w> </span><span class=o>=</span><span class=w> </span>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=w>        </span><span class=k>new</span><span class=w> </span><span class=n>SwerveDriveKinematics</span><span class=p>(</span>
<a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=w>            </span><span class=n>FRONT_LEFT_LOCATION</span><span class=p>,</span>
<a id=__codelineno-15-15 name=__codelineno-15-15 href=#__codelineno-15-15></a><span class=w>            </span><span class=n>FRONT_RIGHT_LOCATION</span><span class=p>,</span>
<a id=__codelineno-15-16 name=__codelineno-15-16 href=#__codelineno-15-16></a><span class=w>            </span><span class=n>BACK_LEFT_LOCATION</span><span class=p>,</span>
<a id=__codelineno-15-17 name=__codelineno-15-17 href=#__codelineno-15-17></a><span class=w>            </span><span class=n>BACK_RIGHT_LOCATION</span>
<a id=__codelineno-15-18 name=__codelineno-15-18 href=#__codelineno-15-18></a><span class=w>        </span><span class=p>);</span>
<a id=__codelineno-15-19 name=__codelineno-15-19 href=#__codelineno-15-19></a><span class=p>}</span>
</code></pre></div> <h3 id=complete-swerve-module-class>Complete Swerve Module Class<a class=headerlink href=#complete-swerve-module-class title="Permanent link">&para;</a></h3> <p>Implementing a swerve module centralizes all motor, encoder, and control logic in a dedicated class. This keeps your code modular and makes it easier to tune, debug, and reuse across different robots.</p> <p>Follow these steps:</p> <ol> <li>Copy the following swerve module class into your robot project.</li> <li>Adjust CAN IDs, gear ratios, and wheel dimensions for your hardware</li> <li>Setup class constructor to take in all CAN IDs needed for your swerve module (drive, steer, absolute encoder)</li> <li>Tune the PID and feedforward constants for your drivetrain. See <a href=../../Chapter_4/simple_profiling/ >Simple profiling</a> for more in depth on tuning velocity control systems.</li> <li>Ensure encoder readings and motor outputs match your mechanical setup (see <a href=#steering-inversion-considerations>Steering Inversion Considerations</a>).</li> </ol> <p>Key features: - Encapsulates drive and steer motor control - Uses PID and feedforward for precise movement - Optimizes wheel rotation for shortest path - Converts encoder readings to physical units</p> <p>Reference: <a href=#motor-control>Motor Control</a>, <a href=#motor-control>Steering Control</a>, <a href=#motor-control>Drive Control</a>, <a href=#wheel-optimization>Wheel Optimization</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SwerveModule</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>TalonFX</span><span class=w> </span><span class=n>driveMotor</span><span class=p>;</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>TalonFX</span><span class=w> </span><span class=n>steerMotor</span><span class=p>;</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>CANcoder</span><span class=w> </span><span class=n>steerEncoder</span><span class=p>;</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>PIDController</span><span class=w> </span><span class=n>steerPID</span><span class=p>;</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>SimpleMotorFeedforward</span><span class=w> </span><span class=n>driveFeedforward</span><span class=p>;</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>PIDController</span><span class=w> </span><span class=n>drivePID</span><span class=p>;</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=w>    </span><span class=c1>// Constants (replace with your actual values)</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>DRIVE_GEAR_RATIO</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>6.75</span><span class=p>;</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>WHEEL_CIRCUMFERENCE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.1016</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>PI</span><span class=p>;</span><span class=w> </span><span class=c1>// 4&quot; wheel in meters</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>SwerveModule</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>driveID</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>steerID</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>encoderID</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=w>        </span><span class=n>driveMotor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>TalonFX</span><span class=p>(</span><span class=n>driveID</span><span class=p>);</span>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=w>        </span><span class=n>steerMotor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>TalonFX</span><span class=p>(</span><span class=n>steerID</span><span class=p>);</span>
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=w>        </span><span class=n>steerEncoder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>CANcoder</span><span class=p>(</span><span class=n>encoderID</span><span class=p>);</span>
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a>
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a><span class=w>        </span><span class=n>driveMotor</span><span class=p>.</span><span class=na>setNeutralMode</span><span class=p>(</span><span class=n>NeutralModeValue</span><span class=p>.</span><span class=na>Brake</span><span class=p>);</span>
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=w>        </span><span class=n>steerMotor</span><span class=p>.</span><span class=na>setNeutralMode</span><span class=p>(</span><span class=n>NeutralModeValue</span><span class=p>.</span><span class=na>Brake</span><span class=p>);</span>
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a><span class=w>        </span><span class=n>steerPID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>PIDController</span><span class=p>(</span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>);</span>
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=w>        </span><span class=n>steerPID</span><span class=p>.</span><span class=na>enableContinuousInput</span><span class=p>(</span><span class=o>-</span><span class=n>Math</span><span class=p>.</span><span class=na>PI</span><span class=p>,</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>PI</span><span class=p>);</span>
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a><span class=w>        </span><span class=n>drivePID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>PIDController</span><span class=p>(</span><span class=mf>0.1</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>,</span><span class=w> </span><span class=mf>0.0</span><span class=p>);</span>
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=w>        </span><span class=n>driveFeedforward</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SimpleMotorFeedforward</span><span class=p>(</span><span class=mf>0.1</span><span class=p>,</span><span class=w> </span><span class=mf>2.0</span><span class=p>);</span>
<a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a>
<a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>setDesiredState</span><span class=p>(</span><span class=n>SwerveModuleState</span><span class=w> </span><span class=n>desiredState</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class=w>        </span><span class=c1>// Optimize the reference state to avoid spinning &gt; 90 degrees</span>
<a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=w>        </span><span class=n>SwerveModuleState</span><span class=w> </span><span class=n>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>SwerveModuleState</span><span class=p>.</span><span class=na>optimize</span><span class=p>(</span>
<a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a><span class=w>            </span><span class=n>desiredState</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Rotation2d</span><span class=p>(</span><span class=n>getSteerAngle</span><span class=p>()));</span>
<a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a>
<a id=__codelineno-16-34 name=__codelineno-16-34 href=#__codelineno-16-34></a><span class=w>        </span><span class=c1>// Calculate steering output</span>
<a id=__codelineno-16-35 name=__codelineno-16-35 href=#__codelineno-16-35></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>steerOutput</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>steerPID</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span>
<a id=__codelineno-16-36 name=__codelineno-16-36 href=#__codelineno-16-36></a><span class=w>            </span><span class=n>getSteerAngle</span><span class=p>(),</span><span class=w> </span><span class=n>state</span><span class=p>.</span><span class=na>angle</span><span class=p>.</span><span class=na>getRadians</span><span class=p>());</span>
<a id=__codelineno-16-37 name=__codelineno-16-37 href=#__codelineno-16-37></a><span class=w>        </span><span class=n>steerMotor</span><span class=p>.</span><span class=na>set</span><span class=p>(</span><span class=n>steerOutput</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>12.0</span><span class=p>);</span><span class=w> </span><span class=c1>// TalonFX expects [-1, 1] for percent output</span>
<a id=__codelineno-16-38 name=__codelineno-16-38 href=#__codelineno-16-38></a>
<a id=__codelineno-16-39 name=__codelineno-16-39 href=#__codelineno-16-39></a><span class=w>        </span><span class=c1>// Calculate drive output</span>
<a id=__codelineno-16-40 name=__codelineno-16-40 href=#__codelineno-16-40></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>driveFF</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>driveFeedforward</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span><span class=n>state</span><span class=p>.</span><span class=na>speedMetersPerSecond</span><span class=p>);</span>
<a id=__codelineno-16-41 name=__codelineno-16-41 href=#__codelineno-16-41></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>driveFB</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>drivePID</span><span class=p>.</span><span class=na>calculate</span><span class=p>(</span>
<a id=__codelineno-16-42 name=__codelineno-16-42 href=#__codelineno-16-42></a><span class=w>            </span><span class=n>getDriveVelocity</span><span class=p>(),</span><span class=w> </span><span class=n>state</span><span class=p>.</span><span class=na>speedMetersPerSecond</span><span class=p>);</span>
<a id=__codelineno-16-43 name=__codelineno-16-43 href=#__codelineno-16-43></a><span class=w>        </span><span class=n>driveMotor</span><span class=p>.</span><span class=na>set</span><span class=p>((</span><span class=n>driveFF</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>driveFB</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>12.0</span><span class=p>);</span><span class=w> </span><span class=c1>// Convert voltage to percent output</span>
<a id=__codelineno-16-44 name=__codelineno-16-44 href=#__codelineno-16-44></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-16-45 name=__codelineno-16-45 href=#__codelineno-16-45></a>
<a id=__codelineno-16-46 name=__codelineno-16-46 href=#__codelineno-16-46></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>SwerveModuleState</span><span class=w> </span><span class=nf>getState</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-47 name=__codelineno-16-47 href=#__codelineno-16-47></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SwerveModuleState</span><span class=p>(</span>
<a id=__codelineno-16-48 name=__codelineno-16-48 href=#__codelineno-16-48></a><span class=w>            </span><span class=n>getDriveVelocity</span><span class=p>(),</span>
<a id=__codelineno-16-49 name=__codelineno-16-49 href=#__codelineno-16-49></a><span class=w>            </span><span class=k>new</span><span class=w> </span><span class=n>Rotation2d</span><span class=p>(</span><span class=n>getSteerAngle</span><span class=p>())</span>
<a id=__codelineno-16-50 name=__codelineno-16-50 href=#__codelineno-16-50></a><span class=w>        </span><span class=p>);</span>
<a id=__codelineno-16-51 name=__codelineno-16-51 href=#__codelineno-16-51></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-16-52 name=__codelineno-16-52 href=#__codelineno-16-52></a>
<a id=__codelineno-16-53 name=__codelineno-16-53 href=#__codelineno-16-53></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=nf>getSteerAngle</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-54 name=__codelineno-16-54 href=#__codelineno-16-54></a><span class=w>        </span><span class=c1>// CANcoder returns [0,1) rotations, convert to radians</span>
<a id=__codelineno-16-55 name=__codelineno-16-55 href=#__codelineno-16-55></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>steerEncoder</span><span class=p>.</span><span class=na>getAbsolutePosition</span><span class=p>().</span><span class=na>getValue</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>PI</span><span class=p>;</span>
<a id=__codelineno-16-56 name=__codelineno-16-56 href=#__codelineno-16-56></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-16-57 name=__codelineno-16-57 href=#__codelineno-16-57></a>
<a id=__codelineno-16-58 name=__codelineno-16-58 href=#__codelineno-16-58></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=nf>getDriveVelocity</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-16-59 name=__codelineno-16-59 href=#__codelineno-16-59></a><span class=w>        </span><span class=c1>// TalonFX velocity is in rotations per second, convert to m/s</span>
<a id=__codelineno-16-60 name=__codelineno-16-60 href=#__codelineno-16-60></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>rotationsPerSecond</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>driveMotor</span><span class=p>.</span><span class=na>getVelocity</span><span class=p>().</span><span class=na>getValue</span><span class=p>();</span>
<a id=__codelineno-16-61 name=__codelineno-16-61 href=#__codelineno-16-61></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>rotationsPerSecond</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>WHEEL_CIRCUMFERENCE</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>DRIVE_GEAR_RATIO</span><span class=p>;</span>
<a id=__codelineno-16-62 name=__codelineno-16-62 href=#__codelineno-16-62></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-16-63 name=__codelineno-16-63 href=#__codelineno-16-63></a><span class=p>}</span>
</code></pre></div> <h3 id=basic-swerve-drive-subsystem-structure>Basic Swerve Drive Subsystem Structure<a class=headerlink href=#basic-swerve-drive-subsystem-structure title="Permanent link">&para;</a></h3> <p>This subsystem serves as the central hub for swerve drive control. It receives commands from the drive controller, manages the coordination of all swerve modules, and ensures each module moves as needed to execute the requested driving actions. Within this subsystem, you instantiate your gyro and swerve modules, then handle all command and feedback operations for swerve movement.</p> <p>Follow these steps: 1. Copy the following swerve drive subsystem into your robot project. 2. Ensure the module array order matches your kinematics setup (see <a href=#kinematics-setup>Kinematics Setup</a>). 3. Adjust CAN IDs and constants as needed for your hardware. Ensure the parameters align with what you defined in your swerve module class.</p> <p>Topics covered: <a href=#swervedrivekinematics-object>SwerveDriveKinematics Object</a>, <a href=#swervemodulestate>SwerveModuleState</a>, <a href=#chassisspeeds>ChassisSpeeds</a>, <a href=#speed-desaturation>Speed Desaturation</a>, <a href=#wheel-optimization>Wheel Optimization</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SwerveDrive</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>SubsystemBase</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>SwerveModule</span><span class=o>[]</span><span class=w> </span><span class=n>modules</span><span class=p>;</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>SwerveDriveKinematics</span><span class=w> </span><span class=n>kinematics</span><span class=p>;</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Gyro</span><span class=w> </span><span class=n>gyro</span><span class=p>;</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>SwerveDrive</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>        </span><span class=c1>// Initialize modules in the same order as kinematics</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=w>        </span><span class=n>modules</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SwerveModule</span><span class=o>[]</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>            </span><span class=k>new</span><span class=w> </span><span class=n>SwerveModule</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>11</span><span class=p>),</span><span class=w> </span><span class=c1>// Front Left</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=w>            </span><span class=k>new</span><span class=w> </span><span class=n>SwerveModule</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>12</span><span class=p>),</span><span class=w> </span><span class=c1>// Front Right</span>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=w>            </span><span class=k>new</span><span class=w> </span><span class=n>SwerveModule</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>,</span><span class=w> </span><span class=mi>13</span><span class=p>),</span><span class=w> </span><span class=c1>// Back Left</span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=w>            </span><span class=k>new</span><span class=w> </span><span class=n>SwerveModule</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=mi>8</span><span class=p>,</span><span class=w> </span><span class=mi>14</span><span class=p>)</span><span class=w>  </span><span class=c1>// Back Right</span>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=w>        </span><span class=p>};</span>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=w>        </span><span class=c1>// Reference kinematics from DriveConstants</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a><span class=w>        </span><span class=n>kinematics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DriveConstants</span><span class=p>.</span><span class=na>KINEMATICS</span><span class=p>;</span>
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a><span class=w>        </span><span class=c1>// Instantiate gyro (CTRE Pigeon2 example)</span>
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=w>        </span><span class=n>gyro</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Pigeon2</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span><span class=w> </span><span class=c1>// CAN ID 0, change as needed</span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a>
<a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>drive</span><span class=p>(</span><span class=n>ChassisSpeeds</span><span class=w> </span><span class=n>chassisSpeeds</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=w>        </span><span class=c1>// Convert chassis speeds to module states</span>
<a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a><span class=w>        </span><span class=n>SwerveModuleState</span><span class=o>[]</span><span class=w> </span><span class=n>moduleStates</span><span class=w> </span><span class=o>=</span>
<a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=w>            </span><span class=n>kinematics</span><span class=p>.</span><span class=na>toSwerveModuleStates</span><span class=p>(</span><span class=n>chassisSpeeds</span><span class=p>);</span>
<a id=__codelineno-17-26 name=__codelineno-17-26 href=#__codelineno-17-26></a>
<a id=__codelineno-17-27 name=__codelineno-17-27 href=#__codelineno-17-27></a><span class=w>        </span><span class=c1>// Desaturate wheel speeds to max allowed</span>
<a id=__codelineno-17-28 name=__codelineno-17-28 href=#__codelineno-17-28></a><span class=w>        </span><span class=n>SwerveDriveKinematics</span><span class=p>.</span><span class=na>desaturateWheelSpeeds</span><span class=p>(</span>
<a id=__codelineno-17-29 name=__codelineno-17-29 href=#__codelineno-17-29></a><span class=w>            </span><span class=n>moduleStates</span><span class=p>,</span><span class=w> </span><span class=n>DriveConstants</span><span class=p>.</span><span class=na>MAX_SPEED_MPS</span><span class=p>);</span>
<a id=__codelineno-17-30 name=__codelineno-17-30 href=#__codelineno-17-30></a>
<a id=__codelineno-17-31 name=__codelineno-17-31 href=#__codelineno-17-31></a><span class=w>        </span><span class=c1>// Command each module to its desired state</span>
<a id=__codelineno-17-32 name=__codelineno-17-32 href=#__codelineno-17-32></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>modules</span><span class=p>.</span><span class=na>length</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-17-33 name=__codelineno-17-33 href=#__codelineno-17-33></a><span class=w>            </span><span class=n>modules</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>.</span><span class=na>setDesiredState</span><span class=p>(</span><span class=n>moduleStates</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>);</span>
<a id=__codelineno-17-34 name=__codelineno-17-34 href=#__codelineno-17-34></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-17-35 name=__codelineno-17-35 href=#__codelineno-17-35></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-17-36 name=__codelineno-17-36 href=#__codelineno-17-36></a>
<a id=__codelineno-17-37 name=__codelineno-17-37 href=#__codelineno-17-37></a>
<a id=__codelineno-17-38 name=__codelineno-17-38 href=#__codelineno-17-38></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>SwerveModuleState</span><span class=o>[]</span><span class=w> </span><span class=nf>getModuleStates</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-17-39 name=__codelineno-17-39 href=#__codelineno-17-39></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Arrays</span><span class=p>.</span><span class=na>stream</span><span class=p>(</span><span class=n>modules</span><span class=p>)</span>
<a id=__codelineno-17-40 name=__codelineno-17-40 href=#__codelineno-17-40></a><span class=w>            </span><span class=p>.</span><span class=na>map</span><span class=p>(</span><span class=n>SwerveModule</span><span class=p>::</span><span class=n>getState</span><span class=p>)</span>
<a id=__codelineno-17-41 name=__codelineno-17-41 href=#__codelineno-17-41></a><span class=w>            </span><span class=p>.</span><span class=na>toArray</span><span class=p>(</span><span class=n>SwerveModuleState</span><span class=o>[]</span><span class=p>::</span><span class=k>new</span><span class=p>);</span>
<a id=__codelineno-17-42 name=__codelineno-17-42 href=#__codelineno-17-42></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-17-43 name=__codelineno-17-43 href=#__codelineno-17-43></a>
<a id=__codelineno-17-44 name=__codelineno-17-44 href=#__codelineno-17-44></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Rotation2d</span><span class=w> </span><span class=nf>getRotation2d</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-17-45 name=__codelineno-17-45 href=#__codelineno-17-45></a><span class=w>        </span><span class=c1>// Get robot heading from gyro</span>
<a id=__codelineno-17-46 name=__codelineno-17-46 href=#__codelineno-17-46></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>gyro</span><span class=p>.</span><span class=na>getRotation2d</span><span class=p>();</span>
<a id=__codelineno-17-47 name=__codelineno-17-47 href=#__codelineno-17-47></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-17-48 name=__codelineno-17-48 href=#__codelineno-17-48></a><span class=p>}</span>
</code></pre></div> <h3 id=teleop-command-implementation>Teleop Command Implementation<a class=headerlink href=#teleop-command-implementation title="Permanent link">&para;</a></h3> <p>This command handles real-time driver input and translates joystick values into swerve drive commands. It applies alliance flipping, deadbands, and scaling, then generates field-relative chassis speeds for the drive subsystem.</p> <p>Follow these steps: 1. Copy the following teleop command class into your robot project. 2. Connect joystick axes to the suppliers (<code>xSupplier</code>, <code>ySupplier</code>, <code>rotSupplier</code>). 3. Ensure alliance flipping logic matches your team's requirements. 4. Adjust deadband and scaling constants as needed.</p> <p>Topics covered: <a href=#joystick-input-to-motor-command>Joystick Input to Motor Command</a>, <a href=#chassisspeeds>ChassisSpeeds</a>, <a href=#alliance-considerations>Alliance Considerations</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>TeleopSwerveCommand</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>CommandBase</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>SwerveDrive</span><span class=w> </span><span class=n>swerve</span><span class=p>;</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span><span class=w> </span><span class=n>xSupplier</span><span class=p>;</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span><span class=w> </span><span class=n>ySupplier</span><span class=p>;</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span><span class=w> </span><span class=n>rotSupplier</span><span class=p>;</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>TeleopSwerveCommand</span><span class=p>(</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=w>        </span><span class=n>SwerveDrive</span><span class=w> </span><span class=n>swerve</span><span class=p>,</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=w>        </span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span><span class=w> </span><span class=n>xSupplier</span><span class=p>,</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=w>        </span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span><span class=w> </span><span class=n>ySupplier</span><span class=p>,</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=w>        </span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>Double</span><span class=o>&gt;</span><span class=w> </span><span class=n>rotSupplier</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>swerve</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>swerve</span><span class=p>;</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>xSupplier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>xSupplier</span><span class=p>;</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>ySupplier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ySupplier</span><span class=p>;</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>rotSupplier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rotSupplier</span><span class=p>;</span>
<a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=w>        </span><span class=n>addRequirements</span><span class=p>(</span><span class=n>swerve</span><span class=p>);</span>
<a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a>
<a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=w>    </span><span class=nd>@Override</span>
<a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>execute</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=w>        </span><span class=c1>// Get joystick inputs via suppliers</span>
<a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>xSpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>ySupplier</span><span class=p>.</span><span class=na>get</span><span class=p>();</span><span class=w>  </span><span class=c1>// Forward/backward</span>
<a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>ySpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>xSupplier</span><span class=p>.</span><span class=na>get</span><span class=p>();</span><span class=w>  </span><span class=c1>// Left/right</span>
<a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>rot</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>rotSupplier</span><span class=p>.</span><span class=na>get</span><span class=p>();</span><span class=w>   </span><span class=c1>// Rotation</span>
<a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a>
<a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a><span class=w>        </span><span class=c1>// Alliance flip for red side</span>
<a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>AllianceFlipUtil</span><span class=p>.</span><span class=na>shouldFlipToRed</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-18-29 name=__codelineno-18-29 href=#__codelineno-18-29></a><span class=w>            </span><span class=n>xSpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>xSpeed</span><span class=p>;</span>
<a id=__codelineno-18-30 name=__codelineno-18-30 href=#__codelineno-18-30></a><span class=w>            </span><span class=n>ySpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>ySpeed</span><span class=p>;</span>
<a id=__codelineno-18-31 name=__codelineno-18-31 href=#__codelineno-18-31></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-18-32 name=__codelineno-18-32 href=#__codelineno-18-32></a>
<a id=__codelineno-18-33 name=__codelineno-18-33 href=#__codelineno-18-33></a><span class=w>        </span><span class=c1>// Apply deadband and scale to max speeds</span>
<a id=__codelineno-18-34 name=__codelineno-18-34 href=#__codelineno-18-34></a><span class=w>        </span><span class=n>xSpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>abs</span><span class=p>(</span><span class=n>xSpeed</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>XboxInterfaceConstants</span><span class=p>.</span><span class=na>kDeadband</span>
<a id=__codelineno-18-35 name=__codelineno-18-35 href=#__codelineno-18-35></a><span class=w>            </span><span class=o>?</span><span class=w> </span><span class=n>xSpeed</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>DriveConstants</span><span class=p>.</span><span class=na>MAX_SPEED_MPS</span>
<a id=__codelineno-18-36 name=__codelineno-18-36 href=#__codelineno-18-36></a><span class=w>            </span><span class=p>:</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
<a id=__codelineno-18-37 name=__codelineno-18-37 href=#__codelineno-18-37></a><span class=w>        </span><span class=n>ySpeed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>abs</span><span class=p>(</span><span class=n>ySpeed</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>XboxInterfaceConstants</span><span class=p>.</span><span class=na>kDeadband</span>
<a id=__codelineno-18-38 name=__codelineno-18-38 href=#__codelineno-18-38></a><span class=w>            </span><span class=o>?</span><span class=w> </span><span class=n>ySpeed</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>DriveConstants</span><span class=p>.</span><span class=na>MAX_SPEED_MPS</span>
<a id=__codelineno-18-39 name=__codelineno-18-39 href=#__codelineno-18-39></a><span class=w>            </span><span class=p>:</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
<a id=__codelineno-18-40 name=__codelineno-18-40 href=#__codelineno-18-40></a><span class=w>        </span><span class=n>rot</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>abs</span><span class=p>(</span><span class=n>rot</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>XboxInterfaceConstants</span><span class=p>.</span><span class=na>kDeadband</span>
<a id=__codelineno-18-41 name=__codelineno-18-41 href=#__codelineno-18-41></a><span class=w>            </span><span class=o>?</span><span class=w> </span><span class=n>rot</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>DriveConstants</span><span class=p>.</span><span class=na>MAX_ANGULAR_SPEED_RAD_PER_SEC</span>
<a id=__codelineno-18-42 name=__codelineno-18-42 href=#__codelineno-18-42></a><span class=w>            </span><span class=p>:</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
<a id=__codelineno-18-43 name=__codelineno-18-43 href=#__codelineno-18-43></a>
<a id=__codelineno-18-44 name=__codelineno-18-44 href=#__codelineno-18-44></a><span class=w>        </span><span class=c1>// Create chassis speeds (field-oriented)</span>
<a id=__codelineno-18-45 name=__codelineno-18-45 href=#__codelineno-18-45></a><span class=w>        </span><span class=n>ChassisSpeeds</span><span class=w> </span><span class=n>chassisSpeeds</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ChassisSpeeds</span><span class=p>.</span><span class=na>fromFieldRelativeSpeeds</span><span class=p>(</span>
<a id=__codelineno-18-46 name=__codelineno-18-46 href=#__codelineno-18-46></a><span class=w>            </span><span class=n>xSpeed</span><span class=p>,</span><span class=w> </span><span class=n>ySpeed</span><span class=p>,</span><span class=w> </span><span class=n>rot</span><span class=p>,</span><span class=w> </span><span class=n>swerve</span><span class=p>.</span><span class=na>getRotation2d</span><span class=p>()</span>
<a id=__codelineno-18-47 name=__codelineno-18-47 href=#__codelineno-18-47></a><span class=w>        </span><span class=p>);</span>
<a id=__codelineno-18-48 name=__codelineno-18-48 href=#__codelineno-18-48></a>
<a id=__codelineno-18-49 name=__codelineno-18-49 href=#__codelineno-18-49></a><span class=w>        </span><span class=c1>// Drive the robot</span>
<a id=__codelineno-18-50 name=__codelineno-18-50 href=#__codelineno-18-50></a><span class=w>        </span><span class=n>swerve</span><span class=p>.</span><span class=na>drive</span><span class=p>(</span><span class=n>chassisSpeeds</span><span class=p>);</span>
<a id=__codelineno-18-51 name=__codelineno-18-51 href=#__codelineno-18-51></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-18-52 name=__codelineno-18-52 href=#__codelineno-18-52></a><span class=p>}</span>
</code></pre></div> <h3 id=integrating-swerve-drive-in-robotcontainer>Integrating Swerve Drive in RobotContainer<a class=headerlink href=#integrating-swerve-drive-in-robotcontainer title="Permanent link">&para;</a></h3> <p>To connect your swerve drive subsystem and teleop command to the overall robot structure: 1. Instantiate both objects in your <code>RobotContainer</code> class. 2. Your <code>TelopSwerveCommand</code> should be instantiated as a <code>default command</code> so that it is running continously.</p> <p><strong>Example RobotContainer Setup:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RobotContainer</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=w>    </span><span class=c1>// Subsystems</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>SwerveDrive</span><span class=w> </span><span class=n>swerveDrive</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SwerveDrive</span><span class=p>();</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>    </span><span class=c1>// Joystick</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>CommandXboxController</span><span class=w> </span><span class=n>driverController</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>CommandXboxController</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>    </span><span class=c1>// Teleop command</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>TeleopSwerveCommand</span><span class=w> </span><span class=n>teleopSwerveCommand</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>TeleopSwerveCommand</span><span class=p>(</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=w>        </span><span class=n>swerveDrive</span><span class=p>,</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=w>        </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>driverController</span><span class=p>.</span><span class=na>getLeftX</span><span class=p>(),</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=w>        </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>driverController</span><span class=p>.</span><span class=na>getLeftY</span><span class=p>(),</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=w>        </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>driverController</span><span class=p>.</span><span class=na>getRightX</span><span class=p>()</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>    </span><span class=p>);</span>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>RobotContainer</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=w>        </span><span class=n>configureBindings</span><span class=p>();</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configureBindings</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=w>        </span><span class=c1>// Set default command for swerve drive</span>
<a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=w>        </span><span class=n>swerveDrive</span><span class=p>.</span><span class=na>setDefaultCommand</span><span class=p>(</span><span class=n>teleopSwerveCommand</span><span class=p>);</span>
<a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a><span class=p>}</span>
</code></pre></div> <p><strong>Key Steps:</strong> - Instantiate the <code>SwerveDrive</code> subsystem. - Create the teleop command, passing joystick axis suppliers. - Set the teleop command as the default for the swerve subsystem. - Place all subsystem and command instantiations in <code>RobotContainer</code> for centralized management.</p> <p>This structure ensures your swerve drive responds to joystick input during teleop and is ready for further autonomous command integration.</p> <h2 id=7-troubleshooting>7. Troubleshooting<a class=headerlink href=#7-troubleshooting title="Permanent link">&para;</a></h2> <h3 id=common-issues-and-possible-fixes>Common Issues and Possible fixes<a class=headerlink href=#common-issues-and-possible-fixes title="Permanent link">&para;</a></h3> <p><strong>Motors not reciving command input from controller</strong> - Trace back your logic and add printlns at each step to see where your code logic stops working</p> <p><strong>Module Not Reaching Target Angle</strong> - Check encoder calibration and offset values - Verify PID tuning parameters - Ensure continuous input is enabled for angle PID</p> <p><strong>Robot Drifting During Movement</strong> - Calibrate gyroscope properly - Check for mechanical issues (loose wheels, etc.) - Verify coordinate system consistency</p> <p><strong>Jerky or Unstable Movement</strong> - Reduce PID gains, especially derivative - Add input filtering/deadbands - Check for sensor noise</p> <p><strong>Modules Fighting Each Other</strong> - Ensure all modules use same coordinate system - Verify kinematics setup matches physical layout - Check for inverted motors or encoders</p> <h3 id=debug-tools>Debug Tools<a class=headerlink href=#debug-tools title="Permanent link">&para;</a></h3> <p><strong>Module State Monitoring:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>updateTelemetry</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>modules</span><span class=p>.</span><span class=na>length</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=w>        </span><span class=n>SwerveModuleState</span><span class=w> </span><span class=n>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>modules</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>.</span><span class=na>getState</span><span class=p>();</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>        </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Module &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot; Speed&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>.</span><span class=na>speedMetersPerSecond</span><span class=p>);</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=w>        </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putNumber</span><span class=p>(</span><span class=s>&quot;Module &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot; Angle&quot;</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=p>.</span><span class=na>angle</span><span class=p>.</span><span class=na>getDegrees</span><span class=p>());</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=p>}</span>
</code></pre></div></p> <p><strong>Field-Relative Position Tracking:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>SwerveDriveOdometry</span><span class=w> </span><span class=n>odometry</span><span class=p>;</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>updateOdometry</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=w>    </span><span class=n>odometry</span><span class=p>.</span><span class=na>update</span><span class=p>(</span><span class=n>gyro</span><span class=p>.</span><span class=na>getRotation2d</span><span class=p>(),</span><span class=w> </span><span class=n>getModuleStates</span><span class=p>());</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=w>    </span><span class=n>SmartDashboard</span><span class=p>.</span><span class=na>putString</span><span class=p>(</span><span class=s>&quot;Robot Pose&quot;</span><span class=p>,</span><span class=w> </span><span class=n>odometry</span><span class=p>.</span><span class=na>getPoseMeters</span><span class=p>().</span><span class=na>toString</span><span class=p>());</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=p>}</span>
</code></pre></div></p> <h3 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">&para;</a></h3> <ol> <li><strong>Start Simple</strong>: Begin with basic teleop control before adding autonomous features</li> <li><strong>Test Incrementally</strong>: Test each module individually before running full swerve</li> <li><strong>Monitor Performance</strong>: Always log module states and robot pose for debugging</li> <li><strong>Consistent Units</strong>: Use meters and radians throughout for consistency with WPILIB</li> </ol> <h2 id=9-reference-resources>9. Reference Resources<a class=headerlink href=#9-reference-resources title="Permanent link">&para;</a></h2> <ul> <li><a href=https://docs.wpilib.org/en/stable/docs/software/kinematics-and-odometry/swerve-drive-kinematics.html>WPILIB Swerve Drive Documentation</a></li> <li><a href=https://docs.yagsl.com>Yagsl Library</a></li> <li><a href=https://github.com/PhantomCatz/RobotCode2025-Reefscape/tree/main/SeasonCode2025/src/main/java/frc/robot/CatzSubsystems/CatzDriveAndRobotOrientation>PhantomCatz RobotCode2025 Swerve Implementation (GitHub)</a></li> </ul> <hr> <p><em>This guide is based on Team 2637's swerve drive training presentation and includes additional implementation details for new programmers.</em></p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 6, 2025 13:17:30 UTC">August 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 6, 2025 13:17:30 UTC">August 6, 2025</span> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! Help us improve this page by using our <a href=... target=_blank rel=noopener>feedback form</a>. </div> </div> </div> </fieldset> </form> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.top", "navigation.sections", "navigation.expand", "navigation.tracking"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.13a4f30d.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/clike/clike.min.js></script> <script src=../../../js/pid-simulator.js></script> </body> </html>